var ReactComponentFactory;ReactComponentFactory=function(){function ReactComponentFactory(){}return ReactComponentFactory.createFactory=function(name,namespace,reactClass){var base;return null!=namespace?(null==(base=React.DOM)[namespace]&&(base[namespace]=[]),React.DOM[namespace][name]=React.createFactory(React.createClass(reactClass))):React.DOM[name]=React.createFactory(React.createClass(reactClass))},ReactComponentFactory}(),ReactComponentFactory.createFactory("Avatar",null,{displayName:"Avatar",render:function(){var avatarClassNames,bgColorCount,img,md5,picture,ref,rsvpClass,rsvpPropertyName,span,user;switch(ref=React.DOM,span=ref.span,picture=ref.picture,img=ref.img,user=this.props.user,rsvpPropertyName="rsvp_status",rsvpClass="rsvp-maybe",avatarClassNames=[this.props.className,"avatar",this.props.size],this.props.isOrganzizer&&avatarClassNames.push("avatar--organizer"),user.scheduling_disabled&&avatarClassNames.push("scheduling-disabled"),null!=(null!=user?user.user_id_md5:void 0)&&(bgColorCount=10,md5=parseInt(user.user_id_md5.substring(0,6),16),avatarClassNames.push("avatar-bg-"+md5%bgColorCount)),user[rsvpPropertyName]){case"yes":rsvpClass="rsvp-yes";break;case"no":rsvpClass="rsvp-no";break;default:rsvpClass="rsvp-maybe"}return picture({className:avatarClassNames.join(" "),title:user.name},span({className:"avatar-initials"},user.image?void 0:span({},user.initials)),user.image?img({className:"avatar-img",src:user.image,alt:user.name}):void 0,this.props.showRsvp?span({className:"avatar-rsvp-overlay "+rsvpClass}):void 0)}}),ReactComponentFactory.createFactory("Timestamp",null,{displayName:"Timestamp",propTypes:{createdAt:React.PropTypes.number.isRequired},render:function(){var span;return(span=React.DOM.span)({className:"notification-time"},moment.unix(this.props.createdAt).format(this.props.dateHelper.formatTimeDayDate))}});var animationReset;animationReset=angular.module("mtnAnimationReset",[]),animationReset.directive("mtnAnimationReset",function(){return{link:function(scope,elem,attrs){return elem[0].style.background="white url('"+attrs.backgroundImage+"?"+(new Date).getTime()+"') center center no-repeat",elem[0].style.backgroundSize=attrs.backgroundSize}}});var animations;animations=angular.module("animations",[]),animations.directive("scrollIntoView",function(){return{restrict:"AE",scope:{ngShow:"="},link:function(scope,elem){var element,scrollIntoView;return element=elem[0],scope.$watch("ngShow",function(visible){return visible?scrollIntoView(element):void 0}),scrollIntoView=function(element){var elementHeight,elementHidden,elementTop,elementVisible,scrollAmount,top,windowHeight;return windowHeight=window.innerHeight,elementHeight=element.clientHeight,elementTop=element.getBoundingClientRect().top,elementVisible=windowHeight-elementTop,elementHidden=elementHeight-elementVisible,scrollAmount=elementHidden,elementTop>windowHeight-elementHeight?(top=document.body.scrollTop+scrollAmount,TweenLite.to(document.body,.5,{scrollTop:top,ease:Power2.easeInOut})):void 0}}}});var mtnAutoGrow;mtnAutoGrow=angular.module("autoGrow",[]),mtnAutoGrow.directive("autoGrow",function($sce){return{restrict:"A",require:"?ngModel",link:function(scope,element,attr,ngModel){var read;if(ngModel)return read=function(){return element.css("height",element[0].scrollHeight+"px"),ngModel.$setViewValue(element[0].value)},ngModel.$render=function(){return element.html($sce.getTrustedHtml(ngModel.$viewValue||"")),element.css("height",element[0].scrollHeight+"px")},element.on("blur keydown keyup change",function(){return scope.$evalAsync(read)}),read()}}});var mtnAutoFocus;mtnAutoFocus=angular.module("mtnAutofocus",[]),mtnAutoFocus.directive("mtnAutofocus",function($timeout){return{restrict:"A",link:function(scope,elem){return $timeout(function(){return scope.$apply(function(){return elem[0].focus()})},700)}}});var mtnAutoscroll;mtnAutoscroll=angular.module("mtnAutoscroll",[]),mtnAutoscroll.directive("mtnAutoscroll",function($timeout){return{restrict:"A",link:function(scope,elem){return scope.$on("$viewContentLoaded",function(){return $timeout(function(){return elem[0].scrollTop=0})})}}});var mtnAvatar;mtnAvatar=angular.module("mtnAvatar",[]),mtnAvatar.directive("mtnAvatar",function(){return{restrict:"E",replace:!0,require:"ngModel",scope:{showRsvp:"=?"},templateUrl:"/views/partials/_avatar.html",link:function(scope,elem,attrs,ngModel){return null==attrs.rsvpPropertyName&&(attrs.rsvpPropertyName="rsvp_status"),null==scope.showRsvp&&(scope.showRsvp=!1),scope.organizer=null!=attrs.organizer,ngModel.$formatters.push(function(user){var bgColorCount;if(null!=user){switch(scope.user=user,user[attrs.rsvpPropertyName]){case"yes":scope.rsvpClass="rsvp-yes";break;case"no":scope.rsvpClass="rsvp-no";break;default:scope.rsvpClass="rsvp-maybe"}return null!=(null!=user?user.user_id_md5:void 0)?(bgColorCount=10,scope.avatarBgClassName="avatar-bg-"+parseInt(user.user_id_md5.substring(0,6),16)%bgColorCount):void 0}})}}});var carousel;carousel=angular.module("mtnCarousel",["appConfig"]),carousel.directive("mtnCarousel",function(javascriptUtils){return{restrict:"A",scope:{afterLastSlide:"&mtnAfterLastSlide"},link:function(scope,elem){var active,bind,carouselWidth,childCount,dX,elemPos,oldX,slide,swipeEnd,swipeMove,swipeStart,unbind,windowWidth;return windowWidth=window.innerWidth,carouselWidth=elem[0].getBoundingClientRect().width,childCount=elem[0].childElementCount,dX=0,oldX=0,elemPos=0,slide=0,active=!1,swipeStart=function(e){var ref;return active=!0,elem.removeClass("static"),oldX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX},swipeEnd=function(){var scrollPos;return active=!1,elem.addClass("static"),slide=Math.round(elemPos/(carouselWidth/childCount)),slide>0&&(slide=0),scrollPos=windowWidth*slide,javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d( "+scrollPos+"px, 0, 0 )"),elemPos=scrollPos,Math.abs(slide)===childCount?scope.$apply(function(){return scope.afterLastSlide()}):void 0},swipeMove=function(e){var dist,mult,pageX,ref;return e.preventDefault(),active?(pageX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX,dX=pageX-oldX,elemPos>0&&(dist=elemPos,mult=1/Math.pow(dist,.45),dX=(pageX-oldX)*mult),elemPos+=dX,javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d( "+elemPos+"px, 0, 0 )"),oldX=pageX):void 0},unbind=function(){return window.navigator.pointerEnabled&&(elem[0].removeEventListener("pointerdown",swipeStart,!1),elem[0].removeEventListener("pointermove",swipeMove,!1),elem[0].removeEventListener("pointerup",swipeEnd,!1),elem[0].removeEventListener("pointerleave",swipeEnd,!1)),elem[0].removeEventListener("touchstart",swipeStart,!1),elem[0].removeEventListener("touchmove",swipeMove,!1),elem[0].removeEventListener("touchend",swipeEnd,!1),elem[0].removeEventListener("touchcancel",swipeEnd,!1),elem[0].removeEventListener("mousedown",swipeStart,!1),elem[0].removeEventListener("mousemove",swipeMove,!1),elem[0].removeEventListener("mouseup",swipeEnd,!1)},(bind=function(){return scope.$on("$destroy",function(){return unbind()}),window.navigator.pointerEnabled&&(elem[0].addEventListener("pointerdown",swipeStart,!1),elem[0].addEventListener("pointermove",swipeMove,!1),elem[0].addEventListener("pointerup",swipeEnd,!1),elem[0].addEventListener("pointerleave",swipeEnd,!1)),elem[0].addEventListener("touchstart",swipeStart,!1),elem[0].addEventListener("touchmove",swipeMove,!1),elem[0].addEventListener("touchend",swipeEnd,!1),elem[0].addEventListener("touchcancel",swipeEnd,!1),elem[0].addEventListener("mousedown",swipeStart,!1),elem[0].addEventListener("mousemove",swipeMove,!1),elem[0].addEventListener("mouseup",swipeEnd,!1)})()}}});var mtnCheckbox;mtnCheckbox=angular.module("mtnCheckbox",[]),mtnCheckbox.directive("mtnCheckbox",function(){return{restrict:"E",transclude:!0,scope:{ngModel:"=",mtnClick:"&",mtnSwipeLeft:"&",mtnSwipeRight:"&",mtnShowSpinner:"=",name:"@"},template:'<div><input type="checkbox" name="{{name}}" id="{{name}}" class="ios7toggle" ng-model="ngModel"><label ng-click="mtnClick()" ng-swipe-left="mtnSwipeLeft()" ng-swipe-right="mtnSwipeRight()"></label><span ng-class="{ \'visible\' : mtnShowSpinner }" class="spinner no-delay"></span><label class="mtnList-toggle-label" ng-click="mtnClick()" ng-swipe-left="mtnSwipeLeft()" ng-swipe-right="mtnSwipeRight()"><span ng-transclude></span></label></div>'}});var ContactPickerCtrl,mtnContactPicker,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};ContactPickerCtrl=function(){function ContactPickerCtrl(scope,rootScope,window,filter1,log,errorHandlerService,contactService,currentUserService,deviceUtils){this.scope=scope,this.rootScope=rootScope,this.window=window,this.filter=filter1,this.log=log,this.errorHandlerService=errorHandlerService,this.contactService=contactService,this.currentUserService=currentUserService,this.deviceUtils=deviceUtils,this._onSelectFromActionSheet=bind(this._onSelectFromActionSheet,this),this.participants=this.scope.participants,this.latestContacts=this.scope.latestContacts,this.onAddParticipant=this.scope.onAddParticipant,this.onRemoveParticipant=this.scope.onRemoveParticipant,this.customVisible=!1,this.customType="phone",this.user=this.currentUserService.get(),this.userCountryId=this.currentUserService.getUserPhoneCountryId(this.user),"web"!==this.deviceUtils.platform()&&this._initContactFilter()}return ContactPickerCtrl.$inject=["$scope","$rootScope","$window","$filter","$log","errorHandlerService","contactService","currentUserService","deviceUtils"],ContactPickerCtrl.prototype._initContactFilter=function(){var debounceFilter;return this.inputModel="",debounceFilter=_.debounce(function(_this){return function(value){return null!=value?_this.findContacts(value,!1):void 0}}(this),300),this.scope.$watch(function(_this){return function(){return _this.inputModel}}(this),function(_this){return function(value){return null!=value&&value.length>2?debounceFilter(value):(_this.contacts=null,debounceFilter(null))}}(this))},ContactPickerCtrl.prototype._clear=function(){return this.customName="",this.customPhonenumber="",this.customEmail="",this.inputModel="",this.contacts=null},ContactPickerCtrl.prototype._onSelectFromActionSheet=function(selectedIndex){var selectedContactField;return selectedIndex--,selectedContactField=this.groupedContacts[0].allContactFields[selectedIndex].value,-1!==_.findIndex(this.groupedContacts[0].phoneNumbers,{value:selectedContactField})?this.addParticipantPhone(this.groupedContacts[0].name,selectedContactField):this.addParticipantEmail(this.groupedContacts[0].name,selectedContactField),this.scope.$apply()},ContactPickerCtrl.prototype.hideDisabled=function(tag){return!tag.scheduling_disabled},ContactPickerCtrl.prototype.disableCustomAdd=function(){return"phone"===this.customType?null==this.customName||null==this.customPhonenumber||""===this.customPhonenumber:"email"===this.customType?null==this.customName||null==this.customEmail||""===this.customEmail:void 0},ContactPickerCtrl.prototype.showCustom=function(){return this.customVisible=!0},ContactPickerCtrl.prototype.toggleCustomType=function(){return this.customType="email"===this.customType?"phone":"email"},ContactPickerCtrl.prototype.onAddTag=function(){var ref;return(null!=(ref=this.contacts)?ref.length:void 0)?this.addParticipantPhone(this.contacts[0].name,this.contacts[0].phoneNumbers[0].value):void 0},ContactPickerCtrl.prototype.onRemoveTag=function(tag){return this.onRemoveParticipant({participant:tag})},ContactPickerCtrl.prototype.addCustomParticipant=function(name,number,email){return"phone"===this.customType?this.addParticipantPhone({formatted:name},number):this.addParticipantEmail({formatted:name},email)},ContactPickerCtrl.prototype.addParticipantPhone=function(name,number){var initials;return this.rootScope.$broadcast("focusInput"),this._clear(),initials=this.contactService.parseInitials(name),this.onAddParticipant({type:"phone",participant:{name:name.formatted,last_name:name.familyName||name.formatted,phone:number,initials:initials}})},ContactPickerCtrl.prototype.addParticipantEmail=function(name,email){var initials;return this.rootScope.$broadcast("focusInput"),this._clear(),initials=this.contactService.parseInitials(name),this.onAddParticipant({type:"email",participant:{name:name.formatted,last_name:name.familyName||name.formatted,email:email,initials:initials}})},ContactPickerCtrl.prototype.pickContact=function(){return this.contactService.pickContact().then(function(_this){return function(contact){return null!=contact.name?_this.findContacts(contact.name.formatted,!0):void 0}}(this),function(_this){return function(failure){return _this.log.error(failure),_this.scope.error=_this.errorHandlerService.handle(failure)}}(this))},ContactPickerCtrl.prototype.findContacts=function(filter,showAsActionSheet){return this.contactService.findContacts(filter.trim()).then(function(_this){return function(contacts){var emails,labels,name,options,phoneNumbers,ref;return _this.log.debug("Found contacts",contacts),_this.groupedContacts=_this.filter("orderBy")(_this.contactService.groupContacts(contacts),"name.formatted",!1),showAsActionSheet?(null!=(ref=_this.groupedContacts[0].phoneNumbers)?ref.length:void 0)?(name=_this.groupedContacts[0].name,phoneNumbers=null!=_this.groupedContacts[0].phoneNumbers?_this.groupedContacts[0].phoneNumbers:[],emails=null!=_this.groupedContacts[0].emails?_this.groupedContacts[0].emails:[],phoneNumbers.length+emails.length!==1?(_this.groupedContacts[0].allContactFields=phoneNumbers.concat(emails),labels=[],_.each(phoneNumbers,function(phoneNumber){return labels.push(phoneNumber.type+": "+phoneNumber.value)}),_.each(emails,function(email){return labels.push(email.type+": "+email.value)}),options={title:"Found multiple numbers for contact",buttonLabels:labels,androidEnableCancelButton:!0,winphoneEnableCancelButton:!0,addCancelButtonWithLabel:"Cancel"},_this.window.plugins.actionsheet.show(options,_this._onSelectFromActionSheet)):(1===phoneNumbers.length&&_this.addParticipantPhone(name,phoneNumbers[0].value),1===emails.length?_this.addParticipantEmail(name,emails[0].value):void 0)):void(_this.scope.error=_this.errorHandlerService.handleAppError(_this.errorHandlerService.EMPTY_PHONE_NUMBER)):_this.contacts=_this.groupedContacts}}(this),function(_this){return function(failure){return _this.log.error("contacts error",failure),_this.scope.error=_this.errorHandlerService.handle(failure)}}(this))},ContactPickerCtrl}(),mtnContactPicker=angular.module("mtnContactPicker",["contactModule","errorHandler","currentUserModule","nativeUi","mtnUtils"]),mtnContactPicker.directive("mtnContactPicker",function(){return{restrict:"E",scope:{participants:"=",latestContacts:"=",error:"=mtnErrorModel",onAddParticipant:"&mtnOnAddParticipant",onRemoveParticipant:"&mtnOnRemoveParticipant"},templateUrl:"/views/partials/_contactPicker.html",controller:"ContactPickerCtrl",controllerAs:"contactPicker"}});var mtnContentEditable;mtnContentEditable=angular.module("contenteditable",[]),mtnContentEditable.directive("contenteditable",["$sce",function($sce){return{restrict:"A",require:"?ngModel",link:function(scope,element,attrs,ngModel){var read;if(ngModel)return read=function(){var html;return html=element.html(),"<br>"===html&&(html=""),ngModel.$setViewValue(html.replace("&nbsp;"," "))},ngModel.$render=function(){return element.html($sce.getTrustedHtml(ngModel.$viewValue||""))},element.on("blur keyup change",function(){return scope.$evalAsync(read)}),read()}}}]);var mtnDialogs;mtnDialogs=angular.module("mtnDialogs",["mtnUtils","mtnUnsafeFilter"]),mtnDialogs.directive("mtnError",function(){return{restrict:"E",scope:{ngModel:"=",mtnButtonClick:"&"},template:'<div class="popup-overlay"></div> <div class="error-container"> <h1 ng-bind="title">Sorry!</h1> <p ng-bind-html="message | unsafe">Error message is missing.</p> <button ng-click="mtnButtonClick()">{{buttonCaption}}</button> </div>',link:function(scope){return scope.$watch("ngModel",function(model){return model?(scope.title=model.title,scope.message=model.message,scope.buttonCaption=model.buttonCaption,-1===document.documentElement.className.indexOf("popup-active")?document.documentElement.className+=" popup-active":void 0):document.documentElement.className=document.documentElement.className.replace(" popup-active","")})}}}),mtnDialogs.directive("mtnConfirm",function(deviceUtils){return{restrict:"E",scope:{ngModel:"="},template:function(){return"web"!==deviceUtils.platform()?"":'<div class="popup-overlay"></div> <div class="dialog-container"> <h1 ng-bind="title">Hello!</h1> <p ng-bind="message">Message is missing.</p> <button class="dual" ng-click="buttonConfirmCallback()"> {{buttonConfirmCaption}} </button> <button class="dual secondary" ng-click="buttonCancelCallback()"> {{buttonCancelCaption}} </button> </div>'},link:function(scope){var showHtmlDialog,showNativeDialog;return showNativeDialog=function(model){return navigator.notification.confirm(model.message,function(selected){return 1===selected?model.buttonConfirmCallback():model.buttonCancelCallback()},model.title,[model.buttonConfirmCaption,model.buttonCancelCaption])},showHtmlDialog=function(model){return scope.title=model.title,scope.message=model.message,scope.buttonConfirmCallback=model.buttonConfirmCallback,scope.buttonConfirmCaption=model.buttonConfirmCaption,scope.buttonCancelCallback=model.buttonCancelCallback,scope.buttonCancelCaption=model.buttonCancelCaption,-1===document.documentElement.className.indexOf("popup-active")?document.documentElement.className+=" popup-active":void 0},scope.$watch("ngModel",function(model){return model?"web"===deviceUtils.platform()?showHtmlDialog(model):showNativeDialog(model):document.documentElement.className=document.documentElement.className.replace(" popup-active","")})}}});var disableScroll;disableScroll=angular.module("mtnDisableScroll",[]),disableScroll.directive("mtnDisableScroll",function(){return{link:function(scope,elem){var bind,touchMove,unbind;return touchMove=function(e){return e.preventDefault()},unbind=function(){return window.navigator.pointerEnabled&&elem[0].removeEventListener("pointermove",touchMove,!1),elem[0].removeEventListener("touchmove",touchMove,!1),elem[0].removeEventListener("mousemove",touchMove,!1)},(bind=function(){return scope.$on("$destroy",function(){return unbind()}),window.navigator.pointerEnabled&&elem[0].addEventListener("pointermove",touchMove,!1),elem[0].addEventListener("touchmove",touchMove,!1),elem[0].addEventListener("mousemove",touchMove,!1)})()}}});var epochToMoment;epochToMoment=angular.module("epochToMoment",["dateHelper"]),epochToMoment.directive("epochModel",function(){return{require:"ngModel",restrict:"A",scope:{},link:function(scope,elem,attrs,ngModel){var UTCMode,converted,format;return format=attrs.epochFormatIfCurrentYear&&"true"===attrs.isCurrentYear?attrs.epochFormatIfCurrentYear:attrs.epochFormat,UTCMode="true"===attrs.utc,converted=function(epoch,format){return UTCMode?moment.unix(epoch).utc().format(format):moment.unix(epoch).format(format)},ngModel.$parsers.unshift(function(data){return UTCMode?moment(data).utc().format("X"):moment(data).format("X")}),ngModel.$formatters.unshift(function(data){return converted(data,format)}),ngModel.$render=function(){return elem.text(ngModel.$viewValue)}}}}),epochToMoment.directive("epoch",function(dateHelper){return{restrict:"AE",scope:{epochData:"="},link:function(scope,elem,attrs){var converted,format,update;return format=attrs.epochFormatIfCurrentYear&&dateHelper.isEpochThisYear(scope.epochData)?attrs.epochFormatIfCurrentYear:attrs.epochFormat,converted=function(epoch,format){return moment.unix(epoch).format(format)},(update=function(epoch,format){return elem.text(converted(epoch,format))})(scope.epochData,format)}}}),epochToMoment.directive("mtnDatetimeInput",function(dateHelper){return{require:"ngModel",restrict:"E",replace:!0,template:'<input type="datetime-local"/>',scope:{ngModel:"=",modelBegin:"=mtnModelBegin",modelEnd:"=mtnModelEnd"},link:function(scope,elem,attrs,ngModel){var converted,format,initWatchers;return format="YYYY-MM-DDTHH:mm:ss",initWatchers=function(){return null!=attrs.mtnPreserveDuration&&scope.$watch("modelBegin",function(newValue,oldValue){var duration,end;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),oldValue=parseInt(oldValue),end=parseInt(scope.modelEnd),duration=end-oldValue,scope.disableNextPreserveDuration||(scope.modelEnd=newValue+duration),scope.disableNextPreserveDuration=!1}),null!=attrs.mtnEnsureMinDuration&&scope.$watch("modelEnd",function(newValue,oldValue){var duration,durationStartPoint;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),durationStartPoint=parseInt(scope.modelBegin),duration=900,durationStartPoint>=newValue?(scope.disableNextPreserveDuration=!0,scope.modelBegin=newValue-duration):void 0}),scope.$watch("ngModel",function(value){return"Invalid date"===value||""===value?(elem[0].blur(),scope.disableNextPreserveDuration=!0,scope.modelBegin=dateHelper.defaultNewMeetingBeginDate(),scope.modelEnd=dateHelper.defaultNewMeetingEndDate(scope.modelBegin)):void 0})},converted=function(epoch,format){return moment.unix(epoch).format(format)},ngModel.$parsers.unshift(function(data){return moment(data).format("X")}),ngModel.$formatters.unshift(function(data){return converted(data,format)}),initWatchers()}}}),epochToMoment.directive("mtnDateInput",function(){return{require:"ngModel",restrict:"E",replace:!0,template:'<input type="date"/>',scope:{ngModel:"=",modelBegin:"=mtnModelBegin",modelEnd:"=mtnModelEnd"},link:function(scope,elem,attrs,ngModel){var converted,format,initWatchers;return format="YYYY-MM-DD",initWatchers=function(){return null!=attrs.mtnPreserveDuration&&scope.$watch("modelBegin",function(newValue,oldValue){var duration,end;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),oldValue=parseInt(oldValue),end=parseInt(scope.modelEnd),duration=end-oldValue,scope.disableNextPreserveDuration||(scope.modelEnd=newValue+duration),scope.disableNextPreserveDuration=!1}),null!=attrs.mtnEnsureMinDuration?scope.$watch("modelEnd",function(newValue,oldValue){var duration,durationStartPoint;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),durationStartPoint=parseInt(scope.modelBegin),duration=2592e3,durationStartPoint>=newValue?(scope.disableNextPreserveDuration=!0,scope.modelBegin=newValue-duration):void 0}):void 0},converted=function(epoch,format){return moment.unix(epoch).format(format)},ngModel.$parsers.unshift(function(data){return moment(data).format("X")}),ngModel.$formatters.unshift(function(data){return converted(data,format)}),initWatchers()}}}),epochToMoment.directive("mtnTimeInput",function(){return{require:"ngModel",restrict:"E",replace:!0,template:'<input type="time"/>',scope:{ngModel:"=",modelBegin:"=mtnModelBegin",modelEnd:"=mtnModelEnd"},link:function(scope,elem,attrs,ngModel){var converted,format,initWatchers;return format="HH:mm",initWatchers=function(){return null!=attrs.mtnPreserveDuration&&scope.$watch("modelBegin",function(newValue,oldValue){var duration,end;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),oldValue=parseInt(oldValue),end=parseInt(scope.modelEnd),duration=end-oldValue,scope.disableNextPreserveDuration||(scope.modelEnd=newValue+duration),scope.disableNextPreserveDuration=!1}),null!=attrs.mtnEnsureMinDuration?scope.$watch("modelEnd",function(newValue,oldValue){var duration,durationStartPoint;if(!isNaN(newValue)&&!isNaN(oldValue))return newValue=parseInt(newValue),durationStartPoint=parseInt(scope.modelBegin),duration=900,durationStartPoint>=newValue?(scope.disableNextPreserveDuration=!0,scope.modelBegin=newValue-duration):void 0}):void 0},converted=function(epoch,format){return moment.unix(epoch).utc().format(format)},ngModel.$parsers.unshift(function(data){return moment.duration(data).asSeconds()}),ngModel.$formatters.unshift(function(data){return converted(data,format)}),initWatchers()}}}),epochToMoment.directive("duration",function(dateHelper){return{restrict:"E",scope:!0,controller:function($scope){return{setBegin:function(begin){return $scope.begin=begin},setEnd:function(end){return $scope.end=end}}},link:function(scope,elem){var update;return scope.$watch("begin",function(){return update()}),scope.$watch("end",function(){return update()}),update=function(){return elem.text(dateHelper.durationString(scope.begin,scope.end))}}}}),epochToMoment.directive("begin",function(){return{restrict:"E",require:["ngModel","^duration"],scope:!0,link:function(scope,elem,attrs,ctrls){var duration,ngModel;return ngModel=ctrls[0],duration=ctrls[1],ngModel.$formatters.unshift(function(data){return duration.setBegin(data)}),ngModel.$render=function(){return duration.setBegin(ngModel.$modelValue)}}}}),epochToMoment.directive("end",function(){return{restrict:"E",require:["ngModel","^duration"],scope:!0,link:function(scope,elem,attrs,ctrls){var duration,ngModel;return ngModel=ctrls[0],duration=ctrls[1],ngModel.$formatters.unshift(function(data){return duration.setEnd(data)}),ngModel.$render=function(){return duration.setEnd(ngModel.$modelValue)}}}});var mtnFloatLabel;mtnFloatLabel=angular.module("mtnFloatLabel",[]),mtnFloatLabel.directive("mtnFloatLabel",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:!0,require:"ngModel",template:'<label class="float-label {{ requiredClass }}" ng-model="ngModel" ng-show="isVisible"">{{labelText}}</label>',link:function(scope,elem,attrs,ngModel){var $input,input;return input=document.getElementById(attrs["for"]),$input=angular.element(input),scope.isVisible=!1,scope.ngModel=input.getAttribute("ng-model"),scope.labelText=input.getAttribute("placeholder")||"Placeholder not found",scope.requiredClass=input.hasAttribute("required")||$input.hasClass("required")?"required":"",input.onfocus=function(){return elem.addClass("hasFocus")},input.onblur=function(){return elem.removeClass("hasFocus")},ngModel.$render=function(){var isEmpty;return isEmpty=ngModel.$isEmpty(input.value),ngModel.$viewValue=input.value,ngModel.$modelValue=input.value,scope.isVisible=!isEmpty}}}});var mtnFullHeight;mtnFullHeight=angular.module("mtnFullHeight",["mtnUtils"]),mtnFullHeight.directive("mtnFullHeight",function(deviceready){return{restrict:"A",link:function(scope,elem){var resize;return resize=function(){var height;return height=document.documentElement.getBoundingClientRect().height,elem[0].style.height=height+"px"},window.addEventListener("resize",resize),deviceready.then(function(){return function(){return resize()}}(this)),resize()}}});var mtnHideParent;mtnHideParent=angular.module("mtnHideParent",[]),mtnHideParent.directive("mtnHideParent",function(){return{restrict:"A",link:function(scope,elem){return elem.parent()[0].style.display="none"}}});var mtnInnerScroll;mtnInnerScroll=angular.module("mtnInnerScroll",[]),mtnInnerScroll.directive("mtnInnerScroll",function(){return{restrict:"A",link:function(scope,elem){var element;return element=elem[0],element.addEventListener("touchstart",function(){var startTopScroll;return startTopScroll=element.scrollTop,element.scrollHeight!==element.clientHeight&&(0>=startTopScroll&&(element.scrollTop=1),startTopScroll+element.offsetHeight>=element.scrollHeight)?element.scrollTop=element.scrollHeight-element.offsetHeight-1:void 0},!1)}}});var mtnA;mtnA=angular.module("mtnA",["appConfig","mtnURL"]),mtnA.directive("mtnA",function($window,appConfig,mtnURL){return{restrict:"E",transclude:!0,replace:!0,scope:{href:"@",altHref:"@?"},template:'<span ng-click="openUrl()" ng-transclude></span>',link:function(scope,elem,attrs){return scope.openUrl=function(){return mtnURL.open(scope.href,scope.altHref,attrs.target)}}}});var mtnMoment;mtnMoment=angular.module("mtnMomentModule",[]),mtnMoment.directive("mtnFormatUnitToMoment",function(){return{restrict:"A",scope:!0,link:function(scope,elem,attrs){return elem.text(moment().set(attrs.unit,attrs.value).format(attrs.mtnFormatUnitToMoment))}}});var mtnMoveCursorToEnd;mtnMoveCursorToEnd=angular.module("mtnMoveCursorToEnd",[]),mtnMoveCursorToEnd.directive("mtnMoveCursorToEnd",function(){return{restrict:"A",link:function(scope,elem,attrs){var bind,moveCursorToEndOfContentEditable,moveCursorToEndOfTextArea;return moveCursorToEndOfTextArea=function(){var length;return length=elem[0].value.length,elem[0].setSelectionRange(length,length)},moveCursorToEndOfContentEditable=function(){var range,selection;return range=document.createRange(),range.selectNodeContents(elem[0]),range.collapse(!1),selection=window.getSelection(),selection.removeAllRanges(),selection.addRange(range)},(bind=function(){var isContentEditable;return isContentEditable=null!=attrs.contenteditable,elem[0].addEventListener("focus",function(){return isContentEditable?moveCursorToEndOfContentEditable():moveCursorToEndOfTextArea()})})()}}});var nativeUi;nativeUi=angular.module("nativeUi",[]),nativeUi.directive("toggledByEvent",function($document){return{restrict:"A",link:function(scope,elem,attrs){return $document.on(attrs.eventName,function(){return scope.$apply(function(){return elem.toggleClass(attrs.eventClass)})})}}}),nativeUi.directive("mtnConfirmClick",function(){return{priority:-1,restrict:"A",scope:{mtnConfirmCallback:"&",buttons:"=mtnConfirmClick"},link:function(scope,element,attrs){return element.bind("click",function(){var buttonOK,message,onConfirm,title;return message=attrs.mtnConfirmMessage,title=attrs.mtnConfirmTitle,buttonOK=1,onConfirm=function(button){return button===buttonOK?scope.mtnConfirmCallback():void 0},navigator.notification.confirm(message,onConfirm,title,scope.buttons)})}}}),nativeUi.directive("mtnBlurOnEvent",function($rootScope){return{restrict:"A",link:function(scope,elem,attrs){return $rootScope.$on(attrs.mtnBlurOnEvent,function(){return null!=attrs.mtnBlurOnEventQuerySelector&&null!=document.querySelector(attrs.mtnBlurOnEventQuerySelector)?document.querySelector(attrs.mtnBlurOnEventQuerySelector).blur():elem[0].blur()})}}}),nativeUi.directive("mtnFocusOnEvent",function($rootScope){return{restrict:"A",link:function(scope,elem,attrs){return $rootScope.$on(attrs.mtnFocusOnEvent,function(){return null!=attrs.mtnFocusOnEventQuerySelector?document.querySelector(attrs.mtnFocusOnEventQuerySelector).focus():elem[0].focus()})}}});var PageWrapperCtrl,pageWrapper;PageWrapperCtrl=function(){function PageWrapperCtrl(scope,location,log,appConfig,deviceUtils,msgChannel,viewParams,urbanAirshipService,connectivity){this.scope=scope,this.location=location,this.log=log,this.appConfig=appConfig,this.deviceUtils=deviceUtils,this.msgChannel=msgChannel,this.viewParams=viewParams,this.urbanAirshipService=urbanAirshipService,this.connectivity=connectivity,this.ngModel=this.scope.ngModel,this.mtnPullToRefreshEnabled=this.scope.mtnPullToRefreshEnabled,this.mtnPullToRefreshCallback=this.scope.mtnPullToRefreshCallback,this.mtnShowNotification=this.scope.mtnShowNotification(),this.connected=this.connectivity.isOnline(),this.isIos=this.deviceUtils.isIos(),null!=this.ngModel.delayedSpinner&&(this.delayedSpinner=this.ngModel.delayedSpinner),this._initMessageListener()}return PageWrapperCtrl.$inject=["$scope","$location","$log","appConfig","deviceUtils","jsonMsgChannel","viewParams","urbanAirshipService","connectivity"],PageWrapperCtrl.prototype._initMessageListener=function(){return this.scope.$on("$destroy",function(_this){return function(){return _this.log.debug("[pageWrapper] destroyed, unsubscribing MsgChannel"),_this.msgChannel.unsubscribe()}}(this)),this.msgChannel.subscribe(function(_this){return function(data){return _this.log.debug("[pageWrapper] received postmessage: ",null!=data?data.event:void 0,data),"openNotification"===(null!=data?data.event:void 0)&&(_this.openNotification(data.notification.extras.nid),_this.scope.$$phase||_this.scope.$apply()),"newNotification"===(null!=data?data.event:void 0)&&(_this.notification=data.notification,_this._debouncePopupDestroy(),_this.scope.$$phase||_this.scope.$apply()),"removeNotification"===(null!=data?data.event:void 0)&&_this._clearNotification(),"connectionStatusChanged"===(null!=data?data.event:void 0)?_this._changeConnectionStatus(data):void 0
}}(this))},PageWrapperCtrl.prototype._debouncePopupDestroy=function(){var debounce;return(debounce=_.debounce(function(_this){return function(){return _this._clearNotification(),_this.scope.$apply()}}(this),1e4))()},PageWrapperCtrl.prototype._clearNotification=function(){return this.notification=null},PageWrapperCtrl.prototype._changeConnectionStatus=function(data){return this.log.debug("Changing connection status, connected == ",data.connected),this.scope.$apply(function(_this){return function(){return _this.connected=data.connected}}(this))},PageWrapperCtrl.prototype.showNotification=function(notification){return null==this.mtnShowNotification?!0:this.mtnShowNotification(notification)},PageWrapperCtrl.prototype.openNotification=function(nid){return this.urbanAirshipService.clearNotifications(),this.msgChannel.publish(JSON.stringify({event:"removeNotification"})),this.viewParams.set({fetchAndOpenNotification:nid}),this.location.path("/notifications")},PageWrapperCtrl.prototype.dismissNotification=function(){return this.msgChannel.publish(JSON.stringify({event:"removeNotification"}))},PageWrapperCtrl}(),pageWrapper=angular.module("pageWrapper",["appConfig","mtnSpinner","mtnDialogs","errorHandler","mtnInnerScroll","mtnUtils","MsgChannel","mtnPullToRefresh","urbanAirshipModule","connectivity"]),pageWrapper.directive("pageWrapper",function(){return{restrict:"E",transclude:!0,controller:"PageWrapperCtrl",controllerAs:"pageWrapper",scope:{ngModel:"=",mtnPullToRefreshEnabled:"=?",mtnPullToRefreshCallback:"&",mtnShowNotification:"&?"},templateUrl:"/views/partials/_pageWrapper.html"}});var partials;partials=angular.module("partials",["participantModule","appConfig","mtnUtils"]),partials.directive("participant",function(){return{restrict:"E",require:"ngModel",scope:{showRsvp:"@?"},templateUrl:"/views/participant/_participant.html",link:function(scope,elem,attrs,ngModel){return null==scope.showRsvp&&(scope.showRsvp=!0),ngModel.$formatters.push(function(data){return scope.participant=data})}}}),partials.directive("participantlist",function(){return{restrict:"E",scope:{participants:"=",rsvpPropertyName:"@"},templateUrl:"/views/meeting/_participantlist.html",link:function(scope,elem,attrs){return scope.showRsvp=attrs.showRsvp||!0,scope.isDisabled=function(participant){return participant[attrs.disabledPropertyName]}}}}),partials.directive("participantsummary",function(participantService){return{restrict:"E",scope:{participants:"=",rsvpPropertyName:"@"},templateUrl:"/views/meeting/_participantsummary.html",link:function(scope,elem,attrs){var update;try{scope.shortSummary=JSON.parse(attrs.shortSummary)}catch(error){scope.shortSummary=!1}return update=function(){return scope.attending=participantService.getAttendingCount(scope.participants,scope.rsvpPropertyName),scope.pending=participantService.getPendingCount(scope.participants,scope.rsvpPropertyName),scope.declined=participantService.getDeclinedCount(scope.participants,scope.rsvpPropertyName)},scope.$watch("participants",function(){return update()}),update()}}}),partials.directive("participantinvitation",function(){return{restrict:"E",scope:{parent:"="},templateUrl:"/views/participant/_participantinvitation.html"}}),partials.directive("mtnSwipeCardOption",function(){return{restrict:"E",scope:{option:"=ngModel",parent:"="},templateUrl:"/views/swipetomeet/_swipecardoption.html"}}),partials.directive("mtnApplicationPromo",function(appConfig,deviceUtils){return{restrict:"E",transclude:!0,templateUrl:"/views/partials/_applicationPromo.html",scope:{phoneform:"@?"},controller:function($scope){return $scope.isIos=deviceUtils.isIos(),$scope.isAndroid=deviceUtils.isAndroid(),$scope.iosStoreUrl=appConfig.appStoreUrls.ios,$scope.androidStoreUrl=appConfig.appStoreUrls.android,$scope.isIos&&$scope.isAndroid||!$scope.isIos&&!$scope.isAndroid?($scope.isUnknown=!0,$scope.isIos=!1,$scope.isAndroid=!1):void 0}}});var mtnProgress;mtnProgress=angular.module("mtnProgress",[]),mtnProgress.directive("mtnUploadProgress",function(){return{restrict:"E",replace:!0,scope:{max:"=",value:"="},template:'<div ng-show="uploaded">Uploading: {{ uploaded }}%<progress max="{{ max }}" value="{{ value }}"></progress></div>',link:function(scope){var update;return scope.$watch("value",function(){return update()}),update=function(){return scope.uploaded=parseInt(scope.value/scope.max*100)}}}});var mtnPullToRefresh;mtnPullToRefresh=angular.module("mtnPullToRefresh",["appConfig","MsgChannel"]),mtnPullToRefresh.directive("mtnPullToRefresh",function($log,$timeout,javascriptUtils,JsonMsgChannel){return{restrict:"A",scope:{mtnPullToRefreshCallback:"&"},link:function(scope,elem,attrs){var active,bind,dY,elemPosY,element,enabled,loading,msgChannel,oldY,ptrInfoElement,ptrLength,swipeEnd,swipeMove,swipeStart,unbind;return enabled="true"===attrs.mtnPullToRefresh,ptrInfoElement=angular.element(document.getElementById("pull-to-refresh")),enabled?ptrInfoElement.addClass("ptr-show"):ptrInfoElement.removeClass("ptr-show"),enabled?(msgChannel=new JsonMsgChannel("PullToRefresh"),element=elem[0],dY=0,oldY=0,elemPosY=0,loading=!1,active=!1,swipeStart=function(e){var ref;if(!loading&&!active)return dY=0,elemPosY=0,oldY=(null!=(ref=e.touches)?ref[0].pageY:void 0)||e.pageY,javascriptUtils.vendorPrefixAttr(ptrInfoElement[0],"transform","translate3d( 0, 0px, 0 )"),ptrInfoElement.addClass("ptr-animated"),element.scrollTop<2?(active=!0,elem.addClass("ptr-active")):void 0},ptrLength=50,swipeMove=function(e){var dist,mult,pageY,ref;if(active&&!loading)return pageY=(null!=(ref=e.touches)?ref[0].pageY:void 0)||e.pageY,dY=pageY-oldY,elemPosY>ptrLength&&(dist=Math.abs(ptrLength-elemPosY),mult=1/Math.pow(dist,.25),dY=(pageY-oldY)*mult),elemPosY+=dY,elemPosY>=0&&(e.preventDefault(),javascriptUtils.vendorPrefixAttr(element,"transform","translate3d( 0, "+elemPosY+"px, 0 )")),elemPosY>=ptrLength&&javascriptUtils.vendorPrefixAttr(ptrInfoElement[0],"transform","translate3d( 0, -44px, 0 )"),oldY=pageY},swipeEnd=function(){return active&&!loading?(elemPosY>=ptrLength?(loading=!0,javascriptUtils.vendorPrefixAttr(element,"transform","translate3d( 0, "+ptrLength+"px, 0 )"),javascriptUtils.vendorPrefixAttr(ptrInfoElement[0],"transform","translate3d( 0, -44px, 0 )"),scope.mtnPullToRefreshCallback()):javascriptUtils.vendorPrefixAttr(element,"transform","translate3d( 0, 0px, 0 )"),active=!1,elem.removeClass("ptr-active")):void 0},unbind=function(){return window.navigator.pointerEnabled&&(elem[0].removeEventListener("pointerdown",swipeStart,!1),elem[0].removeEventListener("pointermove",swipeMove,!1),elem[0].removeEventListener("pointerup",swipeEnd,!1),elem[0].removeEventListener("pointerleave",swipeEnd,!1)),element.removeEventListener("touchstart",swipeStart,!1),element.removeEventListener("touchmove",swipeMove,!1),element.removeEventListener("touchend",swipeEnd,!1),element.removeEventListener("touchcancel",swipeEnd,!1),element.removeEventListener("mousedown",swipeStart,!1),element.removeEventListener("mousemove",swipeMove,!1),element.removeEventListener("mouseup",swipeEnd,!1),msgChannel.unsubscribe()},(bind=function(){return scope.$on("$destroy",function(){return unbind()}),msgChannel=new JsonMsgChannel("PullToRefresh"),msgChannel.subscribe(function(data){return"didFecthAll"===(null!=data?data.event:void 0)?(loading=!1,ptrInfoElement.removeClass("ptr-animated"),javascriptUtils.vendorPrefixAttr(element,"transform","translate3d( 0, 0px, 0 )"),$timeout(function(){return javascriptUtils.vendorPrefixAttr(ptrInfoElement[0],"transform","translate3d( 0, 0px, 0 )")},150)):void 0}),window.navigator.pointerEnabled&&(element.addEventListener("pointerdown",swipeStart,!1),element.addEventListener("pointermove",swipeMove,!1),element.addEventListener("pointerup",swipeEnd,!1),element.addEventListener("pointerleave",swipeEnd,!1)),element.addEventListener("touchstart",swipeStart,!1),element.addEventListener("touchmove",swipeMove,!1),element.addEventListener("touchend",swipeEnd,!1),element.addEventListener("touchcancel",swipeEnd,!1),element.addEventListener("mousedown",swipeStart,!1),element.addEventListener("mousemove",swipeMove,!1),element.addEventListener("mouseup",swipeEnd,!1)})()):void 0}}});var mtnRadioButtonList;mtnRadioButtonList=angular.module("mtnRadioButtonList",[]),mtnRadioButtonList.directive("mtnRadioButtonList",function(){return{restrict:"E",replace:!0,transclude:!0,template:"<div ng-class=\"{'open':mtnRadioButtonList.visible}\"> <div ng-transclude></div> </div>",link:function(scope,elem,attrs){var model;return model=attrs.radioButtonModel,scope.mtnRadioButtonList={visible:!1,toggleVisibility:function(){return scope.mtnRadioButtonList.visible=!scope.mtnRadioButtonList.visible}},scope.$watch(function(){return scope.mtnRadioButtonList.selected},function(value){return value&&null==scope[model].selected&&(scope.mtnRadioButtonList.selected=!1,scope.mtnRadioButtonList.toggleVisibility()),value?void 0:scope[model].selected=null}),scope.$watch(function(){return scope[model].selected},function(value){return value?scope.mtnRadioButtonList.selected=!0:void 0})}}});var mtnSpinner;mtnSpinner=angular.module("mtnSpinner",[]),mtnSpinner.directive("mtnSpinner",function($timeout){return{restrict:"E",replace:!0,template:'<div class="spinner-overlay"><div class="spinner-background"><div class="spinner"></div></div></div>',scope:{ngShow:"=",hasDelay:"="},link:function(scope,elem){var bg,spinner;return bg=angular.element(elem.children()[0]),spinner=angular.element(bg.children()[0]),null!=scope.hasDelay&&scope.$watch("hasDelay",function(hasDelay){return hasDelay?(bg.removeClass("no-delay"),spinner.removeClass("no-delay")):(bg.addClass("no-delay"),spinner.addClass("no-delay"))}),scope.$watch("ngShow",function(visible){return visible?$timeout(function(){return bg.addClass("visible"),spinner.addClass("visible")},5):$timeout(function(){return bg.removeClass("visible"),spinner.removeClass("visible")},5)})}}});var mtnSwipeCard;mtnSwipeCard=angular.module("mtnSwipeCard",["appConfig"]),mtnSwipeCard.directive("mtnSwipeCard",function($timeout,jsonMsgChannel,javascriptUtils){return{restrict:"E",scope:{onAccept:"&mtnSwipeOnAccept",onReject:"&mtnSwipeOnReject",onElementYes:"&mtnSwipeOnElementYes",onElementNo:"&mtnSwipeOnElementNo",enabled:"=mtnSwipeEnabled",data:"=mtnSwipeData",isFirstSwipeAction:"=mtnIsFirstSwipeAction",firstSwipeDialog:"&mtnFirstSwipeDialog"},link:function(scope,elem){var SWIPE_THRESHOLD,answeringEnabled,bind,dX,dY,elemPosX,elemPosY,oldX,oldY,setElemTransform,swipeEnd,swipeMove,swipeStart,swiping,unbind;return SWIPE_THRESHOLD=22,dX=0,dY=0,oldX=0,oldY=0,elemPosX=0,elemPosY=0,answeringEnabled=!1,swiping=!1,setElemTransform=function(translateX,translateY,rotate){return javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d("+translateX+", "+translateY+", 0) rotate("+rotate+")")},swipeStart=function(e){var ref,ref1,ref2;return elem.removeClass("static"),swiping=!0,dX=0,dY=0,oldX=0,oldY=0,elemPosX=0,elemPosY=0,null!=e.touches&&(oldX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX,oldY=(null!=(ref1=e.touches)?ref1[0].pageY:void 0)||e.pageY),answeringEnabled=null!=(null!=(ref2=scope.data.yes_option)?ref2.begin_epoch:void 0)},swipeEnd=function(){return swiping=!1,elemPosX>SWIPE_THRESHOLD&&answeringEnabled?scope.isFirstSwipeAction?(elem.addClass("static"),scope.firstSwipeDialog()(!0,!0),scope.$apply()):TweenLite.to(elem,.1,{css:{x:window.innerWidth,z:.01,rotation:0},ease:Power2.linear,onComplete:scope.onAccept}):-SWIPE_THRESHOLD>elemPosX&&answeringEnabled?scope.isFirstSwipeAction?(elem.addClass("static"),scope.firstSwipeDialog()(!1,!0),scope.$apply()):TweenLite.to(elem,.1,{css:{x:-window.innerWidth,z:.01,rotation:0},ease:Power2.linear,onComplete:scope.onReject}):(elem.addClass("static"),javascriptUtils.vendorPrefixAttr(elem[0],"transform",""))},swipeMove=function(e){var pageX,pageY,ref,ref1;if(swiping)if(e.preventDefault(),pageX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX,pageY=(null!=(ref1=e.touches)?ref1[0].pageY:void 0)||e.pageY,0!==oldX&&(dX=pageX-oldX,dY=pageY-oldY),elemPosX+=dX,elemPosY+=dY,setElemTransform(elemPosX+"px",elemPosY+"px",0-elemPosX/10+"deg"),oldX=pageX,oldY=pageY,elemPosX>SWIPE_THRESHOLD&&answeringEnabled){if(!elem.hasClass("yes"))return elem.addClass("yes"),elem.removeClass("no"),scope.onElementYes()}else{if(!(-SWIPE_THRESHOLD>elemPosX&&answeringEnabled))return elem.removeClass("yes"),elem.removeClass("no");if(!elem.hasClass("no"))return elem.addClass("no"),elem.removeClass("yes"),scope.onElementNo()}},unbind=function(){return window.navigator.pointerEnabled&&(elem[0].removeEventListener("pointerdown",swipeStart,!1),elem[0].removeEventListener("pointermove",swipeMove,!1),elem[0].removeEventListener("pointerup",swipeEnd,!1),elem[0].removeEventListener("pointerleave",swipeEnd,!1)),elem[0].removeEventListener("touchstart",swipeStart,!1),elem[0].removeEventListener("touchmove",swipeMove,!1),elem[0].removeEventListener("touchend",swipeEnd,!1),elem[0].removeEventListener("touchcancel",swipeEnd,!1),elem[0].removeEventListener("mousedown",swipeStart,!1),elem[0].removeEventListener("mousemove",swipeMove,!1),elem[0].removeEventListener("mouseup",swipeEnd,!1),jsonMsgChannel.unsubscribe()},bind=function(){return scope.$on("$destroy",function(){return unbind()}),window.navigator.pointerEnabled&&(elem[0].addEventListener("pointerdown",swipeStart,!1),elem[0].addEventListener("pointermove",swipeMove,!1),elem[0].addEventListener("pointerup",swipeEnd,!1),elem[0].addEventListener("pointerleave",swipeEnd,!1)),elem[0].addEventListener("touchstart",swipeStart,!1),elem[0].addEventListener("touchmove",swipeMove,!1),elem[0].addEventListener("touchend",swipeEnd,!1),elem[0].addEventListener("touchcancel",swipeEnd,!1),elem[0].addEventListener("mousedown",swipeStart,!1),elem[0].addEventListener("mousemove",swipeMove,!1),elem[0].addEventListener("mouseup",swipeEnd,!1),jsonMsgChannel.subscribe(function(){return function(data){return"swipeYes"===(null!=data?data.event:void 0)&&data.optionId===elem.attr("id")&&(elem.addClass("yes"),elem.removeClass("no"),$timeout(function(){return setElemTransform("100%",elemPosY+"px","25deg")},5)),"swipeNo"===(null!=data?data.event:void 0)&&data.optionId===elem.attr("id")&&(elem.addClass("no"),elem.removeClass("yes"),$timeout(function(){return setElemTransform("-100%",elemPosY+"px","-25deg")},5)),"cancelSwipe"===(null!=data?data.event:void 0)?(elem.removeClass("yes"),elem.removeClass("no"),javascriptUtils.vendorPrefixAttr(elem[0],"transform","")):void 0}}(this))},scope.enabled?bind():scope.$watch("enabled",function(val){return val?bind():void 0})}}});var mtnSwipeToReveal;mtnSwipeToReveal=angular.module("mtnSwipeToReveal",["appConfig"]),mtnSwipeToReveal.directive("mtnSwipeToReveal",function(javascriptUtils){return{restrict:"A",scope:{mtnSwipeToRevealEnabled:"&",mtnOnRevealActions:"&",mtnOnHideActions:"&"},link:function(scope,elem,attrs){var MAX_SWIPE_WIDTH,active,bind,calculateMaxSwipeWidth,dX,elemPos,oldX,resetElemPosition,swipeEnd,swipeMove,swipeStart,unbind;if(scope.mtnSwipeToRevealEnabled())return elem.addClass("static"),MAX_SWIPE_WIDTH=0,dX=0,oldX=0,elemPos=0,active=!1,calculateMaxSwipeWidth=function(){return MAX_SWIPE_WIDTH=-100,null!=attrs.mtnSwipeToReveal&&null!=elem[0].parentElement.querySelector("#"+attrs.mtnSwipeToReveal)?MAX_SWIPE_WIDTH=0-elem[0].parentElement.querySelector("#"+attrs.mtnSwipeToReveal).getBoundingClientRect().width:void 0},resetElemPosition=function(){return active?void 0:(elemPos=0,javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d( "+elemPos+"px, 0, 0 )"),scope.$apply(function(){return function(){return scope.mtnOnHideActions()}}(this)))},swipeStart=function(e){var ref;return active=!0,elem.removeClass("static"),0===MAX_SWIPE_WIDTH&&calculateMaxSwipeWidth(),oldX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX},swipeEnd=function(){return active=!1,elem.addClass("static"),elemPos>.5*MAX_SWIPE_WIDTH?resetElemPosition():(elemPos=MAX_SWIPE_WIDTH,javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d( "+elemPos+"px, 0, 0 )"),scope.$apply(function(){return function(){return scope.mtnOnRevealActions()}}(this)))},swipeMove=function(e){var dist,elemLeft,mult,pageX,ref;return pageX=(null!=(ref=e.touches)?ref[0].pageX:void 0)||e.pageX,dX=pageX-oldX,elemLeft=elem[0].getBoundingClientRect().left,elemLeft>=0&&dX>0?!0:(MAX_SWIPE_WIDTH>elemLeft&&(dist=Math.abs(MAX_SWIPE_WIDTH-elemLeft),mult=1/Math.pow(dist,.45),dX=(pageX-oldX)*mult),elemPos+=dX,elemPos>0&&(elemPos=0),javascriptUtils.vendorPrefixAttr(elem[0],"transform","translate3d( "+elemPos+"px, 0, 0 )"),oldX=pageX)},unbind=function(){return window.navigator.pointerEnabled&&(elem[0].removeEventListener("pointerdown",swipeStart,!1),elem[0].removeEventListener("pointermove",swipeMove,!1),elem[0].removeEventListener("pointerup",swipeEnd,!1),elem[0].removeEventListener("pointerleave",swipeEnd,!1),document.removeEventListener("pointerdown",resetElemPosition,!1)),elem[0].removeEventListener("touchstart",swipeStart,!1),elem[0].removeEventListener("touchmove",swipeMove,!1),elem[0].removeEventListener("touchend",swipeEnd,!1),elem[0].removeEventListener("touchcancel",swipeEnd,!1),document.removeEventListener("touchstart",resetElemPosition,!1)},(bind=function(){return scope.$on("$destroy",function(){return unbind()}),window.navigator.pointerEnabled&&(elem[0].addEventListener("pointerdown",swipeStart,!1),elem[0].addEventListener("pointermove",swipeMove,!1),elem[0].addEventListener("pointerup",swipeEnd,!1),elem[0].addEventListener("pointerleave",swipeEnd,!1),document.addEventListener("pointerdown",resetElemPosition,!1)),elem[0].addEventListener("touchstart",swipeStart,!1),elem[0].addEventListener("touchmove",swipeMove,!1),elem[0].addEventListener("touchend",swipeEnd,!1),elem[0].addEventListener("touchcancel",swipeEnd,!1),document.addEventListener("touchstart",resetElemPosition,!1)})()}}});var mtnTagInput;mtnTagInput=angular.module("mtnTagInput",["ngSanitize","contenteditable"]),mtnTagInput.directive("mtnTagInput",function($rootScope){return{restrict:"E",template:'<div class="tags" ng-click="focusInput()"> <ul class="tag-list"> <li class="label">{{tagLabel}}</li> <li ng-repeat="tag in tagList | filter:filterTags" ng-click="removeTag(tag)" class="tag-item" ng-class="{ selected: tag == tagList.selected }" ng-bind="tag[displayProperty]"></li> </ul> <div class="input" ng-model="inputModel" contenteditable="true" autocapitalize="words" autocomplete="off" autocorrect="off"></div> </div>',scope:{tagList:"=ngModel",inputModel:"=inputModel",tagLabel:"@label",onAddTag:"&mtnOnAddTag",onRemoveTag:"&mtnOnRemoveTag",tagFilter:"&mtnTagFilter"},link:function(scope,elem,attrs){return scope.displayProperty=attrs.mtnDisplayProperty,scope.hideProperty=attrs.mtnHideProperty,scope.filterTags=function(tag){return scope.tagFilter({tag:tag})},scope.$watch("inputModel",function(value){return null!=value&&value.length>0?scope.tagList.selected=null:void 0}),elem.bind("keydown",function(e){var key;return key=e.which,(9===key||13===key)&&(e.preventDefault(),null!=scope.onAddTag&&scope.onAddTag(),scope.$apply()),8!==key||null!=scope.inputModel&&""!==scope.inputModel?void 0:(scope.removeTag(),scope.$apply())}),scope.removeTag=function(tag){return null!=tag?scope.tagList.selected===tag?(null!=scope.onRemoveTag?scope.onRemoveTag({tag:scope.tagList.selected}):_.remove(scope.tagList,tag),scope.tagList.selected=null):scope.tagList.selected=tag:null!=scope.tagList.selected?(null!=scope.onRemoveTag?scope.onRemoveTag({tag:scope.tagList.selected}):_.remove(scope.tagList,scope.tagList.selected),scope.tagList.selected=null):scope.tagList.selected=_.last(scope.tagList)},scope.addTag=function(tagName){var tag;return null!=tagName&&""!==tagName?(tag={},tag[scope.displayProperty]=tagName,scope.tagList.push(tag)):void 0},scope.focusInput=function(){return $rootScope.$broadcast("focusInput")}}}});var mtnURL;mtnURL=angular.module("mtnURL",["mtnUtils"]),mtnURL.service("mtnURL",function($q,$window,deviceUtils){return{open:function(href,altHref,target){var deferred;return null==target&&(target="_top"),deferred=$q.defer(),null==href&&deferred.reject(),"web"===deviceUtils.platform()?(null==altHref&&(altHref=href),$window.open(altHref,target),deferred.resolve()):(target="_system",CanOpen(href,function(isInstalled){return isInstalled?($window.open(href,target),deferred.resolve()):null!=altHref?($window.open(altHref,target),deferred.resolve()):deferred.reject()})),deferred.promise}}});var account;account=angular.module("accountModule",["appConfig"]),account.service("accountService",function(appConfig,sessionService,currentUserService){return{generateGoogleAuthUrl:function(state){var googleUrl,stateStr;return stateStr=encodeURIComponent(JSON.stringify(state)),googleUrl="https://accounts.google.com/o/oauth2/auth?",googleUrl+="response_type=code",googleUrl+="&client_id="+appConfig.googleSignIn.clientId,googleUrl+="&redirect_uri="+encodeURIComponent(appConfig.googleSignIn.redirectUri),googleUrl+="&state="+stateStr,googleUrl+="&scope="+encodeURIComponent("https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.google.com/calendar/feeds/ https://www.google.com/m8/feeds"),googleUrl+="&access_type=offline",googleUrl+="&approval_prompt=force"},_verifyGoogleCode:function(){var code,localSession,params,querySession;return code=steroids.view.params.code,querySession=steroids.view.params.session,localSession=sessionService.getGoogleSignInSessionString(),null!=code&&localSession===querySession?(code=decodeURIComponent(steroids.view.params.code.split("#")[0]),params={google_code:code,google_redirect_uri:appConfig.googleSignIn.redirectUri},currentUserService.getRoute().post("connect_google_code",params)):void 0}}});var analyticsModule;analyticsModule=angular.module("analytics",["appConfig","mtnUtils"]),analyticsModule.service("segment",function($rootScope,$location,$window,$timeout,$log,$routeParams,appConfig,sessionService,currentUserService,deviceUtils){return{init:function(){return"undefined"!=typeof analytics&&null!==analytics?(this.identify(),this.initTrackListener()):$timeout(function(_this){return function(){return _this.init()}}(this),100)},identify:function(){return sessionService.isSignedIn()&&null!=currentUserService.get()?analytics.identify(sessionService.getUserId(),_.extend(this.getUser(),this.getAppData())):analytics.identify("signed out",this.getAppData())},reset:function(){return analytics.reset(),analytics.identify("signed out",this.getAppData())},getUser:function(){var user;return user=currentUserService.get(),null==(null!=user?user.email:void 0)?{}:{name:user.name,email:user.email,"Email confirmed":user.email_confirmed,"Free trial has expired":user.free_trial_has_expired,"Google connected":user.google_connected,Organization:user.organization,Title:user.organization_title,"Presumed country code":user.presumed_country_code,"Subscription type":user.subscription_type,"TOS accepted":user.tos_accepted}},getAppData:function(){return{appVersion:appConfig.version,appName:appConfig.appName,build:"web"===deviceUtils.platform()?"web":"mobile"}},initTrackListener:function(){return this.trackRouteChangeSuccess()},trackRouteChangeSuccess:function(){return $rootScope.$on("$routeChangeSuccess",function(_this){return function(event,current){var type;if(!current||!(current.$$route||current).redirectTo)return type=$location.path().replace(/\/[0-9]+/g,""),_this.registerExtraData({"View type":type}),analytics.page(type)}}(this))},registerExtraData:function(options){return options["Meeting id"]=$routeParams.meetingId?$routeParams.meetingId:"",options["Scheduling id"]=$routeParams.schedulingId?$routeParams.schedulingId:"",options.utm_source=null!=$location.search().utm_source?$location.search().utm_source:"",analytics.identify(options)}}});var cacheModule;cacheModule=angular.module("cacheModule",["angular-cache"]),cacheModule.service("cacheService",function(CacheFactory){return this.cache=null,{init:function(name){return CacheFactory.get(name)||CacheFactory.createCache(name,{storageMode:"localStorage"}),this.cache=CacheFactory.get(name)},get:function(name){return this.cache.get(name)},put:function(name,data){return this.cache.put(name,data)},remove:function(name){return this.cache.remove(name)},removeAll:function(){return this.cache.removeAll()},destroy:function(){return this.cache.destroy()}}});var calendar;calendar=angular.module("calendarModule",["appConfig","mtnUtils"]),calendar.service("calendarService",function($log,$q,appConfig,sessionService,deviceUtils){return{_setTimespan:function(){return this.timespanBegin=moment(),this.timespanBeginEpoch=this.timespanBegin.format("X"),this.timespanEnd=moment().add({months:3}),this.timespanEndEpoch=this.timespanEnd.format("X")},_getEventsInRange:function(events,minDate,maxDate){return _.filter(events,function(event){return moment(event.startDate)>=minDate&&moment(event.startDate)<maxDate})},getPermissionAsked:function(){try{return JSON.parse(localStorage.getItem("__calendar_permission_asked"))||"ios"!==deviceUtils.platform()}catch(error){return void 0}},setPermissionAsked:function(value){return localStorage.setItem("__calendar_permission_asked",value)},getTimespanBeginEpoch:function(){return this.timespanBeginEpoch},getTimespanEndEpoch:function(){return this.timespanEndEpoch},getDeviceCalendars:function(){var deferred;return deferred=$q.defer(),window.plugins.calendar.listCalendars(function(calendars){return $log.debug("Got calendars from device",calendars),deferred.resolve(calendars)},function(failure){return $log.error("Failed to get calendars from device",failure),deferred.reject(failure)}),deferred.promise},getEventsFromCalendar:function(calendar){var deferred;return deferred=$q.defer(),window.plugins.calendar.findAllEventsInNamedCalendar(calendar.name,function(_this){return function(events){var eventsInRange;return _this._setTimespan(),eventsInRange=_this._getEventsInRange(events,_this.timespanBegin,_this.timespanEnd),deferred.resolve({calendar:calendar,events:eventsInRange})}}(this),function(){return function(failure){return $log.error("Failed to get calendar events from calendar",calendarName,failure),deferred.reject(failure)}}(this)),deferred.promise},initIOS:function(){var deferred;return deferred=$q.defer(),document.addEventListener("deviceready",function(){return function(){return window.plugins&&window.plugins.calendar?window.plugins.calendar.initialize(function(data){return deferred.resolve(data)},function(failure){return deferred.reject(failure)}):deferred.reject()}}(this)),deferred.promise},initAndroid:function(){var deferred;return deferred=$q.defer(),document.addEventListener("deviceready",function(){return function(){var config;return window.CalendarConnector?(config={apiBaseUrl:appConfig.api.baseUrl,pollInterval:appConfig.calendar.pollInterval},window.CalendarConnector.init(sessionService.getUserId(),sessionService.getToken(),config,function(data){return deferred.resolve(data)},function(failure){return deferred.reject(failure)})):deferred.reject()}}(this)),deferred.promise},init:function(){return"ios"===deviceUtils.platform()?this.initIOS():"android"===deviceUtils.platform()?this.initAndroid():void 0}}});var cameraModule;cameraModule=angular.module("cameraModule",[]),cameraModule.service("cameraService",function($log){return{getPicture:function(){return function(successCallback,errorCallback){var defaults;return defaults={quality:50,sourceType:Camera.PictureSourceType.PHOTOLIBRARY},$log.debug("camera options are:",defaults),navigator.camera.getPicture(successCallback,errorCallback,defaults)}}(this)}});var connectivity;connectivity=angular.module("connectivity",["mtnUtils","MsgChannel"]),connectivity.service("connectivity",function($log,deviceUtils,jsonMsgChannel){var _onDeviceReady;return this.connected=!1,null!==window.mtnApp.fake_connectivity&&($log.debug("Faking connectivity ",window.mtnApp.fake_connectivity),this.connected="online"===window.mtnApp.fake_connectivity),_onDeviceReady=function(_this){return function(){var connectionType;return document.addEventListener("online",function(){return $log.debug("[connectivity] Received online event:",navigator.network.connection.type),_this.connected=!0,jsonMsgChannel.publish(JSON.stringify({event:"connectionStatusChanged",connected:!0}))},!1),document.addEventListener("offline",function(){return $log.debug("[connectivity] Received offline event:",navigator.network.connection.type),_this.connected=!1,jsonMsgChannel.publish(JSON.stringify({event:"connectionStatusChanged",connected:!1}))},!1),connectionType=navigator.network.connection.type.toLowerCase(),"none"===connectionType||"unknown"===connectionType?($log.debug("[connectivity] Initially offline"),_this.connected=!1,jsonMsgChannel.publish(JSON.stringify({event:"connectionStatusChanged",connected:!1}))):($log.debug("[connectivity] Initially online"),_this.connected=!0,jsonMsgChannel.publish(JSON.stringify({event:"connectionStatusChanged",connected:!0})))}}(this),document.addEventListener("deviceready",_onDeviceReady,!1),{isOnline:function(_this){return function(){return $log.debug("[connectivity]",(_this.connected?"On":"Off")+"line"),_this.connected}}(this),isOffline:function(_this){return function(){return $log.debug("[connectivity]",(_this.connected?"On":"Off")+"line"),!_this.connected}}(this)}});var contact;contact=angular.module("contactModule",["appConfig","dateHelper","mtnUtils","errorHandler"]),contact.service("contactService",function($log,$q,appConfig,deviceready,deviceUtils,errorHandlerService){return{getPermissionAsked:function(){try{return JSON.parse(localStorage.getItem("__contacts_permission_asked")||"ios"!==deviceUtils.platform())}catch(error){return void 0}},setPermissionAsked:function(value){return localStorage.setItem("__contacts_permission_asked",value)},getLatestContacts:function(){return JSON.parse(localStorage.getItem("__latest_contacts"))},setLatestContactsForUser:function(userId,contacts){var latestContacts,userContacts;return latestContacts=this.getLatestContacts()||{},userContacts=contacts.concat(latestContacts[userId]||[]),_.remove(userContacts,{id:userId}),_.each(userContacts,function(contact,i){var firstIndex;return firstIndex=_.findIndex(userContacts,{phone:contact.phone}),-1===firstIndex&&(firstIndex=_.findIndex(userContacts,{email:contact.email})),i>firstIndex&&-1!==firstIndex?userContacts[i]=null:void 0}),userContacts=_.without(userContacts,null),latestContacts[userId]=userContacts.slice(0,10),localStorage.setItem("__latest_contacts",JSON.stringify(latestContacts))},parseInitials:function(name){var firstName,formatted,initials,lastName;return initials="",firstName=name.givenName,lastName=name.familyName,formatted=name.formatted,null!=firstName&&(initials=firstName.substr(0,1).toUpperCase()),null!=lastName&&(initials+=lastName.substr(0,1).toUpperCase()),null!=firstName||lastName||null==formatted||(initials=formatted.substr(0,1).toUpperCase()),initials},groupContacts:function(contacts){var tmpContacts;return tmpContacts=[],_.each(contacts,function(contact){var emails,existingContact,phoneNumbers;return existingContact=_.findIndex(tmpContacts,function(search){return search.name.formatted.toUpperCase()===contact.name.formatted.toUpperCase()}),-1!==existingContact?(phoneNumbers=null!=tmpContacts[existingContact].phoneNumbers?tmpContacts[existingContact].phoneNumbers.concat(contact.phoneNumbers):contact.phoneNumbers,emails=null!=tmpContacts[existingContact].emails?tmpContacts[existingContact].emails.concat(contact.emails):contact.emails,tmpContacts[existingContact].phoneNumbers=_(phoneNumbers).without(null).uniq("value").value(),tmpContacts[existingContact].emails=_(emails).without(null).uniq("value").value()):tmpContacts.push(contact)}),tmpContacts},formatPhone:function(phone,countryCode){var countryId,countryName,e164,internationalFormat,localFormat,valid;return _.contains(phone,"###")?{e164:phone,countryId:"TEST",countryName:"Test",valid:!0,localFormat:phone}:(e164=formatE164(countryCode,phone),countryId=countryForE164Number(e164),countryName=countryCodeToName(countryId),valid=isValidNumber(phone,countryId),localFormat=formatLocal(countryId,phone),internationalFormat=formatInternational(countryId,phone),{e164:e164,countryId:countryId,countryName:countryName,valid:valid,localFormat:localFormat,internationalFormat:internationalFormat})
},isValidPhoneNumber:function(phoneNumber,countryCode){var formattedPhone;return formattedPhone=this.formatPhone(phoneNumber,countryCode),formattedPhone.valid},isUserPhoneNumber:function(userPhoneNumber,phoneNumber,countryCode){var formatted,userPhoneFormatted;return formatted=this.formatPhone(phoneNumber,countryCode),userPhoneFormatted=this.formatPhone(userPhoneNumber,countryCode),userPhoneFormatted.e164===formatted.e164},validateParticipantPhone:function(participants,participant,user,userCountryId){var existingParticipant;return this.isValidPhoneNumber(participant.phone,userCountryId)||_.contains(participant.phone,"###")?this.isUserPhoneNumber(user.phone,participant.phone,userCountryId)?{error:errorHandlerService.handleAppError(errorHandlerService.USER_PHONENUMBER)}:(existingParticipant=_.find(participants,function(_this){return function(p){return _this.isUserPhoneNumber(p.phone,participant.phone,userCountryId)}}(this)),null!=existingParticipant?{existingParticipant:existingParticipant}:void 0):{error:errorHandlerService.handleAppError(errorHandlerService.INVALID_PHONE_NUMBER)}},validateParticipantEmail:function(participants,participant,user){var existingParticipant;return user.email===participant.email?{error:errorHandlerService.handleAppError(errorHandlerService.USER_PHONENUMBER)}:(existingParticipant=_.find(participants,function(p){return p.email===participant.email}),null!=existingParticipant?{existingParticipant:existingParticipant}:void 0)},isValidParticipant:function(participants,participant,type,user,userCountryId){return"phone"===type?this.validateParticipantPhone(participants,participant,user,userCountryId):"email"===type?this.validateParticipantEmail(participants,participant,user):void 0},pickContact:function(){return deviceready.then(function(){var deferred;return deferred=$q.defer(),navigator.contacts.pickContact(function(success){return deferred.resolve(success)},function(failure){return deferred.reject(failure)}),deferred.promise})},findContacts:function(filter){return deviceready.then(function(){var deferred,fields,options;return deferred=$q.defer(),options=new ContactFindOptions,options.filter=filter,options.multiple=!0,options.desiredFields=[navigator.contacts.fieldType.name,navigator.contacts.fieldType.phoneNumbers,navigator.contacts.fieldType.emails],fields=[navigator.contacts.fieldType.name],navigator.contacts.find(fields,function(success){return deferred.resolve(success)},function(failure){return deferred.reject(failure)},options),deferred.promise})},init:function(){return this.findContacts("initContactPlugin1234567890")}}});var currentUserModule;currentUserModule=angular.module("currentUserModule",["restangular","SessionModel","errorHandler","appConfig","mtnUtils"]),currentUserModule.service("currentUserService",function($log,sessionService,SessionRestangular,errorHandlerService,appConfig,deviceUtils){return this.user=null,{set:function(user){return this.user=user,localStorage.setItem("__session_currentUser",JSON.stringify(user))},get:function(){return this.user||this.getRestangularized()},getRestangularized:function(){var localStorageUser;return localStorageUser=this.getFromLocalStorage(),null!=localStorageUser?(this.user=SessionRestangular.restangularizeElement(null,localStorageUser,"users",null),this.user):void 0},getFromLocalStorage:function(){return JSON.parse(localStorage.getItem("__session_currentUser"))},getRoute:function(){return SessionRestangular.one("users",sessionService.getUserId())},reload:function(options){return options=options||{},this.getRoute().get(options).then(function(_this){return function(user){return _this.set(user),user}}(this))},update:function(userPromise){return userPromise.put().then(function(_this){return function(user){return _this.set(user),user}}(this))},confirmEmail:function(email){return this.getRoute().post("confirm_email",{user_id:sessionService.getUserId(),email:email,include_pin:1})},confirmPhone:function(phone){return this.getRoute().post("confirm_phone",{user_id:sessionService.getUserId(),phone:phone,include_pin:1})},startTrial:function(){return this.getRoute().post("start_free_trial")},sendProFeaturesEmail:function(){return this.getRoute().post("send_pro_features_email")},sendTestPush:function(channelId){return this.getRoute().post("send_test_push_notification",{device_id:channelId,device_type:deviceUtils.platform(),beta:appConfig.isBetaEnvironment})},setDevicePushStatus:function(channelId,enabled){return this.getRoute().post("set_device_push_status",{device_id:channelId,enabled:enabled,device_type:deviceUtils.platform(),beta:appConfig.isBetaEnvironment})},isNewUser:function(user){return 0===user.email_confirmed&&0===user.phone_confirmed||0===user.tos_accepted},isPro:function(user){return null==user?!1:1===user.is_pro||1===user.is_trial_pro},isTrialExpired:function(user){return 1===user.is_free_trial_expired},getUserPhoneCountryId:function(user){var e164;return e164=_.contains(user.phone,"#")?formatE164("null",user.phone.substr(0,user.phone.indexOf("#"))):formatE164("null",user.phone),countryForE164Number(e164)},getEmailSubmitted:function(){return JSON.parse(localStorage.getItem("__email_submitted"))},setEmailSubmitted:function(emailSubmitted){return localStorage.setItem("__email_submitted",JSON.stringify(emailSubmitted))}}});var dateHelper;dateHelper=angular.module("dateHelper",[]),dateHelper.service("dateHelper",function(){return{oneDayInSeconds:86400,formatDayDateYear:"ddd, MMMM D, YYYY",formatDateYear:"MMMM D, YYYY",formatDate:"MMMM D",formatTimeDayDate:"LT, ddd, MMM D",formatTimeDate:"LT, ddd, MMM D",formatDayDate:"ddd, MMM D",formatDayOfWeek:"dddd",formatDayOfWeekShort:"ddd",formatDayOfWeekShortest:"dd",formatTime:"LT",initCustomLocales:function(){return moment.locale("12h",{longDateFormat:{LT:"h:mm a"}}),moment.locale("24h",{longDateFormat:{LT:"H:mm"}})},defaultNewMeetingBeginDate:function(){var nextNoon;return nextNoon=moment().startOf("day").add(12,"hours"),moment().get("hour")>=12&&nextNoon.add(1,"days"),nextNoon.format("X")},defaultNewMeetingEndDate:function(begin){var oneHourAfter;return oneHourAfter=moment.unix(begin).add(1,"hours"),oneHourAfter.format("X")},defaultNewSchedulingBeginDate:function(){var start;return start=moment().startOf("day"),start.format("X")},defaultNewSchedulingEndDate:function(begin){var oneMonthAfter;return oneMonthAfter=moment.unix(begin).add(1,"months"),oneMonthAfter.format("X")},durationString:function(begin,end){var dDays,dHourString,dMinuteString,duration;return duration=moment.duration(end-begin,"seconds"),dDays=duration.days(),dDays>=1?duration.humanize():(dHourString=0!==duration.hours()?duration.hours()+" h ":"",dMinuteString=0!==duration.minutes()?duration.minutes()+" min":"",dHourString+dMinuteString)},isEpochUnset:function(epoch){return"0"===epoch||0===epoch||!epoch},todayEpoch:function(){return this.today().unix()},today:function(){return moment().startOf("day")},yesterdayEpoch:function(){return this.yesterday().unix()},yesterday:function(){return this.today().subtract(1,"days")},tomorrow:function(){return this.today().add(1,"days")},tomorrowEpoch:function(){return this.tomorrow().unix()},dayOfWeek:function(){return moment().day()},isEpochTomorrow:function(epoch){var date;return date="YYYY-MM-DD",moment.unix(epoch).format(date)===this.tomorrow().format(date)},isEpochYesterday:function(epoch){var date;return date="YYYY-MM-DD",moment.unix(epoch).format(date)===this.yesterday().format(date)},isEpochToday:function(epoch){var date;return date="YYYY-MM-DD",moment.unix(epoch).format(date)===this.today().format(date)},thisWeekStart:function(){return moment().startOf("week")},thisWeekStartEpoch:function(){return this.thisWeekStart().unix()},thisWeekEnd:function(){return moment().endOf("week")},thisWeekEndEpoch:function(){return this.thisWeekEnd().unix()},isEpochThisWeek:function(epoch){return epoch>=this.thisWeekStartEpoch()&&epoch<=this.thisWeekEndEpoch()},isEpochThisWeekInPast:function(epoch){return epoch<this.yesterday().unix()&&epoch>=this.thisWeekStartEpoch()},isEpochThisWeekInFuture:function(epoch){return this.isEpochThisWeek(epoch)&&epoch>=this.tomorrowEpoch()},nextWeekStart:function(){return this.thisWeekStart().add(1,"weeks")},nextWeekStartEpoch:function(){return this.nextWeekStart().unix()},nextWeekEnd:function(){return this.thisWeekEnd().add(1,"weeks")},nextWeekEndEpoch:function(){return this.nextWeekEnd().unix()},isEpochNextWeek:function(epoch){return epoch>=this.nextWeekStartEpoch()&&epoch<=this.nextWeekEndEpoch()},isEpochFurtherInFuture:function(epoch,days){return epoch>moment().startOf("day").add(days,"days").unix()},lastWeekEnd:function(){return this.thisWeekEnd().subtract(1,"weeks")},lastWeekEndEpoch:function(){return this.lastWeekEnd().unix()},lastWeekStart:function(){return this.thisWeekStart().subtract(1,"weeks")},lastWeekStartEpoch:function(){return this.lastWeekStart().unix()},isEpochLastWeek:function(epoch){return epoch>=this.lastWeekStartEpoch()&&epoch<=this.lastWeekEndEpoch()},isEpochFurtherInPast:function(epoch,days){return epoch<this.today().subtract(days,"days").unix()&&!this.isEpochUnset(epoch)},thisYearStartEpoch:function(){return moment().startOf("year").unix()},thisYearEndEpoch:function(){return moment().endOf("year").unix()},isEpochThisYear:function(epoch){return epoch>=this.thisYearStartEpoch()&&epoch<=this.thisYearEndEpoch()},isEpochInFuture:function(epoch){return epoch>this.todayEpoch()},isDurationOverADay:function(startEpoch,endEpoch){return endEpoch-startEpoch>86340},dateToEpoch:function(date){return moment(date).format("X")},formatTimezone:function(timezone){return moment().tz(timezone).format("Z")}}});var errorHandler;errorHandler=angular.module("errorHandler",["appConfig","connectivity","mtnUtils"]),errorHandler.factory("$exceptionHandler",function($window,$log){return function(exception){return null!=$window.Raven&&$window.appEnvironment.sentry.enabled&&$window.Raven.captureException(exception,{tags:{category:"Console"}}),$log.error(exception)}}),errorHandler.service("errorHandlerService",function(appConfig,sessionService,connectivity,$window,$log,$analytics,deviceUtils){return{APP_OPEN_FAILED:15e3,SKYPE_OPEN_FAILED:15001,INVALID_LINKEDIN_URL:15002,GOOGLE_SIGNIN_FAILED:15003,INVALID_EMAIL:15004,EMPTY_EMAIL:15005,INVALID_FORM:15006,EMPTY_CONTACT_LIST:15007,START_SCHEDULING_FAILED:15008,EMPTY_PHONE_NUMBER:15009,PHONENUMBER_EXISTS:15010,USER_PHONENUMBER:15011,INVALID_SCHEDULING:15012,INVALID_PHONE_NUMBER:15013,handleAppError:function(errorCode,msg){switch(errorCode){case this.APP_OPEN_FAILED:return this.appOpenFailed();case this.SKYPE_OPEN_FAILED:return this.appOpenFailed("skype");case this.INVALID_LINKEDIN_URL:return this.appInvalidLinkedInUrl();case this.GOOGLE_SIGNIN_FAILED:return this.appGoogleSignInFailed();case this.INVALID_EMAIL:return this.invalidEmail();case this.EMPTY_EMAIL:return this.emptyEmail();case this.INVALID_FORM:return this.invalidForm();case this.EMPTY_CONTACT_LIST:return this.emptyContactlist();case this.INVALID_SCHEDULING:return this.invalidScheduling(msg);case this.START_SCHEDULING_FAILED:return this.startSchedulingFailed();case this.EMPTY_PHONE_NUMBER:return this.emptyPhonenumber();case this.PHONENUMBER_EXISTS:return this.phonenumberExists();case this.USER_PHONENUMBER:return this.userPhoneNumber();case this.INVALID_PHONE_NUMBER:return this.invalidPhoneNumber()}return this.unknown()},handle:function(failure){var ref;if(null!=failure?failure.mtnAppErrorCode:void 0)return handleAppError(failure.mtnAppErrorCode);switch(null!=failure?failure.status:void 0){case 0:return this.timeout(failure);case 401:return this.authenticate(failure);case 404:return this.notFoundOrUnavailable(failure)}switch(null!=failure&&null!=(ref=failure.error)?ref.code:void 0){case 401:return this.authenticate(failure);case 403:return this.accessDenied(failure)}return this.isCalendarPermissionDenied(failure)?this.openSettings():this.isContactPermissionDenied(failure)?this.openSettings():this.isFileTransferAbort(failure)?this.cancelledUpload():this.isPhotoSelectAbort(failure)?this.cancelledPhotoSelect():this.unknown(failure)},accessDenied:function(failure){return $log.warn("[error handler] Access denied error:",failure),this.msg("It seems that you do not have permission to access the content of this meeting.",{title:"Access denied",failure:failure})},notFoundOrUnavailable:function(failure){return sessionService.isSignedIn()?this.msg("Sorry, there was a server problem. This may also be a connectivity issue.",{title:"Not found (404)",buttonCaption:"Refresh",failure:failure}):this.authenticate()},unknown:function(failure){var ref;return $log.warn("[error handler] Unknown error:",failure),(null!=failure&&null!=(ref=failure.error)?ref.message:void 0)?this.msg(failure.error.message,{title:"Unexpected error",failure:failure}):this.msg("Sorry, we made a mistake",{title:"Unknown error",failure:failure})},cancelledUpload:function(){return null},cancelledPhotoSelect:function(){return null},isFileTransferAbort:function(failure){return(null!=failure?failure.hasOwnProperty("body"):void 0)&&(null!=failure?failure.hasOwnProperty("http_status"):void 0)&&(null!=failure?failure.code:void 0)===FileTransferError.ABORT_ERR},isPhotoSelectAbort:function(failure){return"no image selected"===failure||"Selection cancelled."===failure},openSettings:function(){return"ios"===deviceUtils.platform()&&deviceUtils.version()>=8?window.OpenSettings.open():void 0},isCalendarPermissionDenied:function(failure){return"Access not granted"===failure},isContactPermissionDenied:function(failure){return"undefined"==typeof ContactError||null===ContactError?!1:(null!=failure?failure.code:void 0)===ContactError.PERMISSION_DENIED_ERROR},timeout:function(failure){return $log.warn("[error handler] Request timeout"),connectivity.isOffline()?this.msg("Your internet connection seems to be offline.",{category:"connectivity",title:"No connection",buttonCaption:"Refresh",failure:failure}):this.msg("Sorry this seems to take too long. Please try again.",{title:"Request timed out",buttonCaption:"Refresh",failure:failure})},authenticate:function(){return $log.warn("[error handler] API requires authentication."),sessionService.signOut()},appOpenFailed:function(type){var opts;switch(opts={title:"Oops.."},type){case"skype":return this.msg("Unable to open the requested application, are you sure you have installed Skype?",opts);default:return this.msg("Unable to open the requested application.",opts)}},appInvalidLinkedInUrl:function(){var msg;return msg="The LinkedIn profile should be a full web address to your profile starting with 'http://'",this.msg(msg,{title:"Please notice"})},appGoogleSignInFailed:function(){var msg;return msg="Google sign in failed. Please try again.",this.msg(msg,{title:"We are sorry"})},invalidEmail:function(){var msg;return msg="Please enter a valid email address",this.msg(msg,{title:"Invalid address"})},invalidForm:function(){var msg;return msg="There are errors in the form",this.msg(msg,{title:"Invalid input"})},emptyEmail:function(){var msg;return msg="Please enter at least one valid email address",this.msg(msg,{title:"Invalid address"})},emptyContactlist:function(){var msg;return msg="Please enter at least one participant before continuing",this.msg(msg,{title:"Sorry!"})},invalidScheduling:function(msg){return this.msg(msg,{title:"Bummer!"})},startSchedulingFailed:function(msg){return msg="We couldn't find even one suitable time to suggest. Try adjusting the scheduling rules to allow more possibilities.",this.msg(msg,{title:"No times available"})},emptyPhonenumber:function(){var msg;return msg="Selected contact does not have a phone number",this.msg(msg,{title:"Sorry!"})},phonenumberExists:function(){var msg;return msg="This contact has already been added.",this.msg(msg,{title:"I'm already here!"})},userPhoneNumber:function(){var msg;return msg="We automatically invite you to the meeting you have created.",this.msg(msg,{title:"You're already invited."})},invalidPhoneNumber:function(){var msg;return msg="Please enter a valid phone number.",this.msg(msg,{title:"Invalid phone number."})},msg:function(msg,options){var buttonCaption,category,failure,title;return options=options||{},category=options.category||null,title=options.title||"Sorry!",buttonCaption=options.buttonCaption||"Ok",failure=options.failure||null,$analytics.eventTrack("Error",{"Error title":title,"Error message":msg,"Error category":category}),null!=$window.Raven&&$window.appEnvironment.sentry.enabled&&$window.Raven.captureException(title+": "+msg,{extra:failure,tags:{category:"Dialog"}}),{message:msg,title:title,buttonCaption:buttonCaption,isConnectivityIssue:"connectivity"===category}}}});var matchmakerModule;matchmakerModule=angular.module("matchmakerModule",["appConfig"]),matchmakerModule.service("matchmakerService",function($q,SessionRestangular,LocalDataRestangular,sessionService,currentUserService,dateHelper,cacheService){return{setCache:function(matchmakers){return cacheService.put("matchmakers",matchmakers)},getCache:function(){return cacheService.get("matchmakers")},setMatchmakerObject:function(matchmaker){return this.matchmaker=matchmaker},getMatchmakerObject:function(){var user;return null!=this.matchmaker?this.matchmaker:(user=currentUserService.get(),{user_id:sessionService.getUserId(),duration:30,buffer:30,name:"Lunch with "+user.name,time_zone:user.time_zone,meeting_type:"2"})},filterMatchmakers:function(matchmakers){return _(matchmakers).filter(function(matchmaker){var ref;return(null!=(ref=matchmaker.available_timespans)?ref.length:void 0)>0?matchmaker.available_timespans[0].end>=dateHelper.todayEpoch():!0}).where({meetme_hidden:0}).value()},checkMeetmeUrlAvailability:function(meetmeFragment){var deferred;return deferred=$q.defer(),SessionRestangular.one("users").get({user_fragment:meetmeFragment}).then(function(){return function(){return deferred.reject("Meet me url unavailable")}}(this),function(){return function(failure){return 404===failure.status?deferred.resolve():deferred.reject(failure)}}(this)),deferred.promise},addMatchmaker:function(matchmaker){return currentUserService.getRoute().post("matchmakers",matchmaker)},fetchMatchmakers:function(){return currentUserService.getRoute().all("matchmakers").getList()},fetchLunchScheduler:function(){return LocalDataRestangular.all("lunch_scheduler").getList()}}});var materialModule;materialModule=angular.module("materialModule",["cameraModule","appConfig"]),materialModule.service("materialService",function($q,$log,SessionRestangular,cameraService,uploadProgress,appConfig){return this.fileTransfer=null,{materialRoute:function(materialId){return SessionRestangular.one("meeting_materials",materialId)},getMaterialEditLock:function(materialId){return this.materialRoute(materialId).post("edits")},continueMaterialEdit:function(materialId){return this.materialRoute(materialId).post("continue_edit")},cancelEditing:function(editId){return SessionRestangular.one("meeting_material_edits",editId).remove()},fetchMaterial:function(materialId){return this.materialRoute(materialId).get()},fetchComments:function(materialId){return this.materialRoute(materialId).getList("comments")},addComment:function(materialId,params){return this.materialRoute(materialId).post("comments",params)},removeComment:function(materialId,commentId){return this.materialRoute(materialId).one("comments",commentId).remove()},removeMaterial:function(materialId){return this.materialRoute(materialId).remove()},updateMaterial:function(materialId,editData,content){var material;return material=this.materialRoute(materialId),material.edit_id=editData.id,material.content=content,material.old_content=editData.content,material.put()},addPhoto:function(thumbnailSize){var deferred,onFailure,onSuccess;return deferred=$q.defer(),onSuccess=function(_this){return function(fileURL){return _this.uploadPhoto(fileURL,thumbnailSize).then(function(data){return deferred.resolve(JSON.parse(data.response))},function(failure){return deferred.reject(failure)},function(fileTransferProgress){return deferred.notify(uploadProgress.convert(fileTransferProgress))})}}(this),onFailure=function(failure){return $log.error("Failed to get picture from plugin:",failure),deferred.reject(failure)},cameraService.getPicture(onSuccess,onFailure),deferred.promise},uploadPhoto:function(fileUrl,thumbnailSize){var deferred,endpoint,fileName,options;return endpoint=appConfig.api.baseUrl+"/uploads",deferred=$q.defer(),this.fileTransfer=new FileTransfer,options=new FileUploadOptions,fileName=fileUrl.substr(fileUrl.lastIndexOf("/")+1),(null!=fileName?fileName.length:void 0)&&(options.fileName=fileName),options.params={create_thumbnail:1,width:thumbnailSize,height:thumbnailSize},this.fileTransfer.onprogress=deferred.notify,this.fileTransfer.upload(fileUrl,encodeURI(endpoint),deferred.resolve,deferred.reject,options),deferred.promise},abortAddPhoto:function(){return this.fileTransfer.abort()}}}),materialModule.factory("uploadProgress",function(){return{convert:function(fileTransferProgress){return{loaded:fileTransferProgress.loaded,total:fileTransferProgress.total}}}});var meetingModule;meetingModule=angular.module("meetingModule",["ngRoute","appConfig"]),meetingModule.service("meetingService",function($log,$routeParams,SessionRestangular,appConfig,viewParams,cacheService){return this.meeting=null,{setCache:function(meetings){return cacheService.put("meetings",meetings)},getCache:function(){return cacheService.get("meetings")},setMeeting:function(meeting){return this.meeting=meeting},getMeeting:function(){return null!=this.meeting?SessionRestangular.copy(this.meeting):this.getEmptyMeeting()},getEmptyMeeting:function(){return{id:this.getIdFromPath(),meetingDataNotAvailable:!0,participants:[]}},getIdFromPath:function(){var id;return id=$routeParams.meetingId,"undefined"===id?void 0:id},generateTitle:function(participants,base){var title;return null==base&&(base="Meeting with"),title=2===participants.length?base+" "+participants[0].last_name+" & "+participants[1].last_name:base+" "+participants[0].last_name+" & "+(participants.length-1)+" others"},meetingRoute:function(meetingId){return SessionRestangular.one("meetings",meetingId)},fetchMeeting:function(meetingId,params){return this.meetingRoute(meetingId).get(params)},timelineFields:{limit_fields:["id","title_value","location_value","begin_epoch","end_epoch","date_string","is_draft","matchmaking_accepted","is_suggested_meeting","matchmaking_requester_name","source_name","current_scheduling_id","online_conferencing_option","online_conferencing_data.*","participants.*.user_id","participants.*.image","participants.*.initials","participants.*.user_id_md5"]},fetchUnscheduled:function(user){return user.getList("unscheduled_meetings",_.extend({include_draft:1,image_size:appConfig.thumbnail.small},this.timelineFields))},fetchScheduled:function(user,params){return user.getList("meetings",_.extend(params,this.timelineFields))},fetchSuggested:function(user,params){return user.getList("suggested_meetings",_.extend(params,this.timelineFields))},createSuggested:function(meetingId){return SessionRestangular.all("meetings").customPOST({from_suggestion_id:meetingId})},hideSuggested:function(meetingId){return SessionRestangular.one("suggested_meetings",meetingId).customPUT({disabled:1})},getTypeIconClass:function(meeting){return["icon-meetings","icon-coffee","icon-dinner","icon-drinks","icon-workshop","icon-sports","icon-team","icon-idea","icon-material_presentation","icon-calendars","icon-handshake","icon-call","icon-tablet","icon-teleconf","icon-onlineconf","icon-touch"][parseInt(meeting.meeting_type)]},getBackgroundImageUrl:function(meeting){return null==(null!=meeting?meeting.background_theme:void 0)||""===meeting.background_theme?"":"c"!==meeting.background_theme?"images/matchmakers/theme"+(parseInt(meeting.background_theme)+1)+".jpg":meeting.background_image_url||""},isRemoved:function(meeting){return null!=meeting.removed_epoch&&0!==parseInt(meeting.removed_epoch)},isSchedulingStarted:function(meeting,scheduling){return null==scheduling&&(scheduling=meeting.current_scheduling),0!==meeting.current_scheduling_id&&null!=(null!=scheduling?scheduling.started_epoch:void 0)&&0!==scheduling.started_epoch},isSchedulingCanceled:function(meeting,scheduling){return null==scheduling&&(scheduling=meeting.current_scheduling),0!==meeting.current_scheduling_id&&null!=(null!=scheduling?scheduling.canceled_epoch:void 0)&&0!==scheduling.canceled_epoch},isSchedulingFailed:function(meeting,scheduling){return null==scheduling&&(scheduling=meeting.current_scheduling),0!==meeting.current_scheduling_id&&null!=(null!=scheduling?scheduling.failed_epoch:void 0)&&0!==scheduling.failed_epoch},isSchedulingCompleted:function(meeting,scheduling){return null==scheduling&&(scheduling=meeting.current_scheduling),null!=(null!=scheduling?scheduling.completed_epoch:void 0)&&0!==scheduling.completed_epoch}}});var navigationBarModule;navigationBarModule=angular.module("navigationBarModule",["mtnUtils"]),navigationBarModule.service("navigationBarService",function($rootScope,$window,$location,deviceUtils){return{menuVisible:!0,navBarVisible:!0,defaultBackButton:function(){return{title:"Back",onClick:function(){return function(){return $rootScope.$broadcast("blurInput"),$window.history.back()}}(this)}},buttonToPath:function(path){return{title:"Back",onClick:function(){return function(){return $rootScope.$broadcast("blurInput"),$location.path(path)}}(this)}},update:function(options){var ref,ref1;return null!=options.title&&(this.title=options.title),this.leftButton=null,this.rightButton=null,null!=(null!=(ref=options.buttons)?ref.left:void 0)?("ios"!==deviceUtils.platform()&&this.hideMenu(),this.leftButton=options.buttons.left):this.showMenu(),null!=(null!=(ref1=options.buttons)?ref1.right:void 0)?this.rightButton=options.buttons.right:void 0},show:function(title){return this.navBarVisible=!0,this.title=title},hide:function(){return this.navBarVisible=!1},hideMenu:function(){return this.menuVisible=!1},showMenu:function(){return this.menuVisible=!0}}});var notifications;notifications=angular.module("notifications",["currentUserModule","sessionModule","urbanAirshipModule","MsgChannel","mtnUtils","SessionModel"]),notifications.service("notificationService",function($rootScope,$q,$log,$interval,currentUserService,sessionService,urbanAirshipService,appConfig,cacheService,deviceUtils,vsprintfUtils){return{setCache:function(notifications){return cacheService.put("notifications",notifications)},getCache:function(){return cacheService.get("notifications")},getPermissionAsked:function(){try{return JSON.parse(localStorage.getItem("__notification_permission_asked")||"ios"!==deviceUtils.platform())}catch(error){return void 0}},setPermissionAsked:function(value){return localStorage.setItem("__notification_permission_asked",value)},initUrbanAirship:function(){return this.getPermissionAsked()?urbanAirshipService.init():$q.defer().promise},registerDevice:function(){return urbanAirshipService.setAlias(sessionService.getUserId())},unregisterUrbanAirship:function(){return urbanAirshipService.setAlias("")},indexRoute:function(){return currentUserService.getRoute().all("notifications")},formatNotificationTemplates:function(notifications){return _.each(notifications,function(){return function(notification){var params;return params=vsprintfUtils.formatParams(notification.data),notification.data.template=vsprintf(notification.data.template,params)}}(this)),notifications},fetchAll:function(){return this.indexRoute().getList().then(function(_this){return function(notifications){return $log.debug("[notifications] received:",{notifications:notifications}),_this.setBadges(notifications),_this.notifications=_this.formatNotificationTemplates(notifications),_this.setCache(_this.notifications),notifications}}(this))},fetchNotification:function(nid){return currentUserService.getRoute().one("notifications",nid).get().then(function(){return function(notification){return $log.debug("[notifications] received:",{notification:notification}),notification}}(this))},markRead:function(notification){return currentUserService.getRoute().one("notifications",notification.id).customPOST({},"mark_read")},markAllSeen:function(notifications){var ids;return ids=_.map(notifications,function(notification){return notification.id}),$log.debug("Mark these notifications as seen: ",ids),this.indexRoute().customPOST({id_list:ids},"mark_seen")},hasUnseenNotifications:function(collection){var unseen;return unseen=_.find(collection,function(one){return 0===one.is_seen}),null!=unseen},pollForNewNotifications:function(){return this.pollPromise=this.poll(function(_this){return function(){return $log.debug("Polling for new notifications"),_this.fetchAll()}}(this))},stopPollingForNewNotifications:function(){return $log.debug("Polling for new notifications canceled"),this.cancelPoll(this.pollPromise),this.pollPromise=null},poll:function(callback){return $interval(callback,appConfig.notifications.pollInterval)},cancelPoll:function(pollPromise){return $interval.cancel(pollPromise)},setBadges:function(notifications){var count;return count=_.where(notifications,{is_seen:0}).length,this.setBadgeValue(count)},resetBadges:function(){return this.setBadgeValue(null)},setBadgeValue:function(badge){return(null==badge||0===badge)&&(badge=""),this.badge=badge,this.setTabBadge(badge),"ios"===deviceUtils.platform()?this.setAppBadge(badge):void 0},setTabBadge:function(badge){var tabs;return tabs=appConfig.tabs,tabs[appConfig.tabIndex.notification].badge=badge+""},setAppBadge:function(badge){return urbanAirshipService.setBadgeNumber(badge)}}});var participantModule;participantModule=angular.module("participantModule",["SessionModel"]),participantModule.service("participantService",function($log,SessionRestangular){return{getParticipant:function(userId,participants){return _.find(participants,function(participant){return participant.user_id===userId})},getAttending:function(participants,rsvpPropertyName){return _.filter(participants,function(p){return"yes"===p[rsvpPropertyName]||1===p[rsvpPropertyName]})},getPending:function(participants,rsvpPropertyName){return _.filter(participants,function(p){return!p[rsvpPropertyName]||""===p[rsvpPropertyName]||0===p[rsvpPropertyName]})},getDeclined:function(participants,rsvpPropertyName){return _.filter(participants,function(p){return"no"===p[rsvpPropertyName]})},getCurrentSchedulingAnswered:function(participants){return _.where(participants,{has_answered_current_scheduling:1})},getAttendingCount:function(participants,rsvpPropertyName){return this.getAttending(participants,rsvpPropertyName).length},getPendingCount:function(participants,rsvpPropertyName){return this.getPending(participants,rsvpPropertyName).length},getDeclinedCount:function(participants,rsvpPropertyName){return this.getDeclined(participants,rsvpPropertyName).length},getCurrentSchedulingAnsweredCount:function(participants){return this.getCurrentSchedulingAnswered(participants).length},getManager:function(participants){return _.where(participants,{is_manager:"1"})[0]},isManager:function(participant){return 1===parseInt(null!=participant?participant.is_manager:void 0,10)},hasLeftScheduling:function(participant){return 1===parseInt(null!=participant?participant.scheduling_disabled:void 0,10)},isRsvpRequired:function(participant){return 1===parseInt(null!=participant?participant.rsvp_required:void 0,10)&&(!participant.rsvp_status||""===participant.rsvp_status)},updateRsvpStatus:function(participantId,rsvpStatus){var meetingParticipants;return meetingParticipants=SessionRestangular.one("meeting_participants",participantId),meetingParticipants.rsvp=rsvpStatus,meetingParticipants.put()},restangularizeElement:function(participant){return SessionRestangular.restangularizeElement(null,participant,"meeting_participants",{})},fetchParticipant:function(participantId,params){return SessionRestangular.one("meeting_participants",participantId).get(params)},fetchParticipantList:function(meetingId,params){return SessionRestangular.one("meetings",meetingId).getList("participants",params)
},addParticipant:function(meetingId,opts){return SessionRestangular.one("meetings",meetingId).customPOST(opts,"participants")},sendInvitationsToDraftParticipants:function(meetingId,opts){return SessionRestangular.one("meetings",meetingId).customPOST(opts,"send_draft_participant_invites")},removeParticipant:function(participantId){return SessionRestangular.one("meeting_participants",participantId).remove()},fetchUser:function(params){return SessionRestangular.one("users").get(params)},resendSchedulingInvitation:function(participant){return participant.post("resend_invitation",{})},disableScheduling:function(participant){return SessionRestangular.one("meeting_participants",participant.id).customPOST(participant,"disable_scheduling")},enableScheduling:function(participant){return SessionRestangular.one("meeting_participants",participant.id).customPOST(participant,"enable_scheduling")}}});var pusherModule;pusherModule=angular.module("pusherModule",["appConfig"]),pusherModule.service("pusherService",function($log,appConfig,sessionService){return{init:function(){var pusherConfig;return $log.debug("[Pusher] Initializing Pusher"),pusherConfig={authEndpoint:appConfig.pusher.authEndpoint,auth:{headers:{user_id:sessionService.getUserId(),dic:sessionService.getToken()}}},this.pusher=new Pusher(appConfig.pusher.key,pusherConfig)},destroy:function(){return $log.debug("[Pusher] Destroying Pusher"),this.pusher=null},getChannel:function(channelName){var existingChannel;return existingChannel=this.pusher.channel(channelName),null!=existingChannel?existingChannel:this.pusher.subscribe(channelName)},bind:function(channel,eventName,callback){return channel.bind(eventName,callback)},unbind:function(channelName,eventName,callback){var channel;return channel=this.pusher.channel(channelName),null!=channel?channel.unbind(eventName,callback):void 0},subscribeAndBind:function(channelName,eventName,callback){var channel;return null==this.pusher&&this.init(),channel=this.getChannel(channelName),this.bind(channel,eventName,callback)}}});var redirectModule;redirectModule=angular.module("redirectModule",["ngRoute","appConfig","viewParams"]),redirectModule.service("redirectService",function($location,sessionService,SessionRestangular,viewParams){return{cleanQueryParams:function(){return $location.search("user_id",null),$location.search("dic",null),$location.search("redirect_to_meeting",null),$location.search("redirect_to_scheduling",null),$location.search("redirect_to_scheduling_log",null),$location.search("redirect_to_material",null)},redirectToAppstorePage:function(){return this.cleanQueryParams(),$location.path("/appStoreRedirect")},redirectToScheduling:function(meetingId,schedulingId,source){return this.cleanQueryParams(),$location.search("utm_source",source).path("/timeline/meeting/"+meetingId+"/scheduling/"+schedulingId)},redirectToSchedulingLog:function(meetingId,schedulingId){return this.cleanQueryParams(),viewParams.set({showMeetingDetailsButton:!0}),$location.path("/timeline/meeting/"+meetingId+"/scheduling/"+schedulingId+"/log")},redirectToMaterial:function(meetingId,materialId){return this.cleanQueryParams(),$location.path("/timeline/meeting/"+meetingId+"/material/"+materialId)},redirectToMeeting:function(meetingId){return this.cleanQueryParams(),$location.path("/timeline/meeting/"+meetingId)},handleQueryParams:function(){var queryParams;return queryParams=$location.search(),sessionService.signInWithUserIdAndToken(queryParams.user_id,queryParams.dic)?(SessionRestangular.refreshDefaultHeaders(),null!=queryParams.redirect_to_app_store&&this.redirectToAppstorePage(),null!=queryParams.redirect_to_meeting&&null!=queryParams.redirect_to_scheduling&&this.redirectToScheduling(queryParams.redirect_to_meeting,queryParams.redirect_to_scheduling,queryParams.utm_source),null!=queryParams.redirect_to_meeting&&null!=queryParams.redirect_to_scheduling_log&&this.redirectToSchedulingLog(queryParams.redirect_to_meeting,queryParams.redirect_to_scheduling_log),null!=queryParams.redirect_to_meeting&&null!=queryParams.redirect_to_material&&this.redirectToMaterial(queryParams.redirect_to_meeting,queryParams.redirect_to_material),null!=queryParams.redirect_to_meeting?this.redirectToMeeting(queryParams.redirect_to_meeting):void 0):!1}}});var schedulingModule;schedulingModule=angular.module("schedulingModule",["appConfig"]),schedulingModule.service("schedulingService",function($log,meetingService,SessionRestangular,appConfig,dateHelper){return this.scheduling=null,{startScheduling:function(meetingId,params){return meetingService.meetingRoute(meetingId).post("schedulings",params)},schedulingsRoute:function(meetingId,schedulingsId){return meetingService.meetingRoute(meetingId).one("schedulings",schedulingsId)},fetchScheduling:function(meetingId,schedulingsId){return this.schedulingsRoute(meetingId,schedulingsId).get()},fetchOption:function(meetingId,schedulingsId,optionId){return this.schedulingsRoute(meetingId,schedulingsId).one("options",optionId).get()},fetchNextOption:function(meetingId,schedulingsId){return this.schedulingsRoute(meetingId,schedulingsId).post("provide_next_option")},fetchNextOptions:function(meetingId,schedulingsId,optionId,parentOptionId,parentAnswer){var params;return params={parent_option_id:parentOptionId,parent_option_answer:parentAnswer},this.schedulingsRoute(meetingId,schedulingsId).one("options",optionId).post("provide_next_options",params)},answerOption:function(meetingId,schedulingsId,optionId,answer){var params;return params={answer:answer},this.schedulingsRoute(meetingId,schedulingsId).one("options",optionId).post("answers",params)},setScheduling:function(scheduling){return this.scheduling=scheduling},getScheduling:function(){return null!=this.scheduling?SessionRestangular.copy(this.scheduling):{}},formatSelectedDays:function(days){var selectedDays;return selectedDays=[],_.each(days,function(day,index){return day?selectedDays.push(index):void 0}),selectedDays},formatSchedulingSlots:function(days,beginSecond,endSecond){var i,j,len,slots;for(slots=[],j=0,len=days.length;len>j;j+=1)i=days[j],slots.push({weekday:i,begin_second:beginSecond,end_second:endSecond});return slots},getSelectedDaysFromSlots:function(slots){var days;return days=[!1,!1,!1,!1,!1,!1,!1],_.each(slots,function(slot){return days[slot.weekday]=!0}),days},isValidScheduling:function(s2m){var errors,timeframeSeconds;return errors={msg:""},null!=s2m.scheduling.available_timespans[0].end&&s2m.scheduling.available_timespans[0].end<dateHelper.todayEpoch()&&(errors.invalidTimespanEnd=!0,errors.msg+="Scheduling end date is set before this day."),null!=s2m.scheduling.available_timespans[0].end&&s2m.scheduling.available_timespans[0].end<=s2m.scheduling.available_timespans[0].start&&(errors.invalidTimespan=!0,""!==errors.msg&&(errors.msg+="<br>"),errors.msg+="Scheduling end date is set before start date."),s2m.scheduling.is_scheduling_template&&(0===s2m.scheduling.slots.length&&(errors.invalidTime=!0,""!==errors.msg&&(errors.msg+="<br>"),errors.msg+="At least one day should be selected."),s2m.scheduling.slots.length>0&&(timeframeSeconds=s2m.scheduling.slots[0].end_second-s2m.scheduling.slots[0].begin_second,60*s2m.scheduling.duration>timeframeSeconds&&(errors.invalidDuration=!0,""!==errors.msg&&(errors.msg+="<br>"),errors.msg+="Duration is longer than the timeframe."),s2m.scheduling.slots[0].end_second<=s2m.scheduling.slots[0].begin_second&&(errors.invalidTime=!0,""!==errors.msg&&(errors.msg+="<br>"),errors.msg+="End time is before start time."))),errors}}});var schedulingLogModule;schedulingLogModule=angular.module("schedulingLogModule",["schedulingModule","dateHelper","mtnUtils"]),schedulingLogModule.service("schedulingLogService",function(schedulingService,dateHelper,cssClassUtils,vsprintfUtils){return{logRoute:function(meetingId,schedulingsId){return schedulingService.schedulingsRoute(meetingId,schedulingsId).all("log_entries")},fetchAll:function(meetingId,schedulingsId,params){return this.logRoute(meetingId,schedulingsId).getList(params)},fetchLogEntry:function(meetingId,schedulingsId){return this.logRoute(meetingId,schedulingsId).get(lid)},sortUserStates:function(userStateChanges){var userStates;return userStates={invited:[],removed:[],availability_needed:[],common_time_found:[]},_(userStateChanges).groupBy(function(stateChange){return stateChange.data.user_id}).each(function(){return function(user){var lastUserState;return user?(lastUserState=_.max(user,"entry_epoch"),userStates[lastUserState.data.state].push(lastUserState.data)):void 0}}(this)).value(),userStates},formatInstructionChanges:function(instructionChanges){var lastChange,params;return lastChange=_.last(instructionChanges),null!=lastChange?(params=vsprintfUtils.formatParams(lastChange),vsprintf(lastChange.msg,params)):void 0},formatLogMessages:function(logData){var eventLog;return eventLog=[],_.each(logData,function(){return function(item){var formattedMsg,params;switch(params=vsprintfUtils.formatParams(item),formattedMsg=vsprintf(item.msg,params),item.entry_type){case"instruction_changed":break;default:return eventLog.push({formattedMsg:formattedMsg,timestamp:item.entry_epoch})}}}(this)),eventLog}}});var sentryModule;sentryModule=angular.module("sentryModule",["appConfig","sessionModule","currentUserModule","mtnUtils"]),sentryModule.service("sentry",function($window,appConfig,sessionService,currentUserService,deviceUtils){return{init:function(){var user,userId;return appConfig.sentry.enabled?(user=sessionService.isSignedIn()?currentUserService.get():null,userId=(null!=user?user.id:void 0)||"Signed out",$window.Raven.setUserContext({id:userId}),$window.Raven.setTagsContext({version:appConfig.version,appName:appConfig.appName,build:"web"===deviceUtils.platform()?"web":"mobile"})):void 0}}});var sessionModule;sessionModule=angular.module("sessionModule",["restangular","SessionModel","appConfig","mtnUtils"]),sessionModule.service("sessionService",function(AuthenticationRestangular,$log,$window,$location,appConfig,deviceUtils,cacheService){return{getShowCarousel:function(){var showCarousel;return showCarousel=JSON.parse(localStorage.getItem("__show_carousel")),null==showCarousel?(this.setShowCarousel(!1),!0):showCarousel},setShowCarousel:function(value){return localStorage.setItem("__show_carousel",value)},getFirstAppLaunch:function(){var firstAppLaunch;return firstAppLaunch=JSON.parse(localStorage.getItem("__first_app_launch")),null==firstAppLaunch?!0:firstAppLaunch},setFirstAppLaunch:function(value){return localStorage.setItem("__first_app_launch",value)},getBypassCalendarConnectList:function(){var bypassCalendarConnectList;return bypassCalendarConnectList=localStorage.getItem("__bypass_calendar_connect_list"),bypassCalendarConnectList?JSON.parse(bypassCalendarConnectList):[]},setBypassCalendarConnectList:function(value){return localStorage.setItem("__bypass_calendar_connect_list",JSON.stringify(value))},getBypassCalendarConnectForUser:function(){var list,userId;return list=this.getBypassCalendarConnectList(),userId=this.getUserId(),_.contains(list,userId)},addUserToBypassCalendarConnectList:function(){var list,userId;return this.getBypassCalendarConnectForUser()?void 0:(list=this.getBypassCalendarConnectList(),userId=this.getUserId(),list.push(userId),this.setBypassCalendarConnectList(list))},getBypassMeetmeWizard:function(){var bypassMeetmeWizard;return bypassMeetmeWizard=localStorage.getItem("__bypass_meetme_wizard"),null!=bypassMeetmeWizard&&"true"===bypassMeetmeWizard},setBypassMeetmeWizard:function(value){return localStorage.setItem("__bypass_meetme_wizard",value)},checkLogin:function(){return this.isSignedIn()?void 0:this.showSignInView()},getToken:function(){return localStorage.getItem("__session_token")},setToken:function(token){return localStorage.setItem("__session_token",token)},getUserId:function(){var userId;return userId=localStorage.getItem("__session_userId"),"null"===userId?null:userId},setUserId:function(userId){return localStorage.setItem("__session_userId",userId)},setGoogleSignInSessionString:function(sessionString){return localStorage.setItem("__login_session_string",sessionString)},getGoogleSignInSessionString:function(){return localStorage.getItem("__login_session_string")},isSignedIn:function(){return null!=this.getUserId()},showSignInView:function(){return-1===$window.location.hash.indexOf("redirect_to_meeting")?$location.path("/signin"):void 0},clear:function(){return $log.debug("[Session Service] Clearing local storage"),localStorage.removeItem("__session_token"),localStorage.removeItem("__session_userId"),localStorage.removeItem("__session_currentUser"),cacheService.removeAll()},broadcastExpiry:function(){return $log.debug("[Session Service] Broadcasting session expiry message"),window.postMessage("__session_expired","*")},initEventListener:function(onSignOut){return window.addEventListener("message",function(){return function(msg){return"__session_expired"===msg.data?onSignOut():void 0}}(this))},requestPin:function(email){return AuthenticationRestangular.all("login").post({email:email,include_pin:"1",allow_register:"1",time_zone:jstz.determine().name()})},requestPinWithPhonenumber:function(phone){return AuthenticationRestangular.all("login").post({phone:phone,include_pin:"1",allow_register:"1",time_zone:jstz.determine().name()})},signOut:function(){return this.broadcastExpiry(),this.clear(),this.showSignInView()},signInSuccess:function(data){return this.setToken(data.result.token),this.setUserId(data.result.user_id),data},signIn:function(email,pin){return AuthenticationRestangular.all("login").post({email:email,pin:pin,device_type:deviceUtils.platform(),beta:appConfig.isBetaEnvironment}).then(function(_this){return function(data){return _this.signInSuccess(data)}}(this))},signInWithPhonenumber:function(phone,pin){return AuthenticationRestangular.all("login").post({phone:phone,pin:pin,device_type:deviceUtils.platform(),beta:appConfig.isBetaEnvironment}).then(function(_this){return function(data){return _this.signInSuccess(data)}}(this))},signInWithGoogle:function(code){return AuthenticationRestangular.all("login").post({google_code:code,google_redirect_uri:appConfig.googleSignIn.redirectUri,device_type:deviceUtils.platform(),beta:appConfig.isBetaEnvironment,time_zone:jstz.determine().name()}).then(function(_this){return function(data){return _this.signInSuccess(data)}}(this))},signInWithUserIdAndToken:function(userId,token){return null!=userId&&null!=token?(this.setUserId(userId),this.setToken(token),!0):!1}}});var splashscreenModule;splashscreenModule=angular.module("splashscreen",["mtnUtils"]),splashscreenModule.service("splashscreen",function(deviceUtils){return{hide:function(){var ref;if("web"!==deviceUtils.platform())return null!=(ref=navigator.splashscreen)?ref.hide():void 0}}});var suggestion;suggestion=angular.module("suggestionModule",["appConfig","calendarModule","dateHelper","mtnUtils"]),suggestion.service("suggestionService",function($q,$log,$interval,$timeout,appConfig,calendarService,currentUserService,sessionService,dateHelper,deviceUtils){return{_getContainerName:function(deviceModel){var containerName;switch(containerName="",deviceModel){case"iPhone1,1":containerName="iPhone 2G";break;case"iPhone1,2":containerName="iPhone 3G";break;case"iPhone2,1":containerName="iPhone 3GS";break;case"iPhone3,1":containerName="iPhone 4";break;case"iPhone3,2":containerName="iPhone 4";break;case"iPhone3,3":containerName="iPhone 4";break;case"iPhone4,1":containerName="iPhone 4S";break;case"iPhone5,1":containerName="iPhone 5";break;case"iPhone5,2":containerName="iPhone 5";break;case"iPhone5,3":containerName="iPhone 5c";break;case"iPhone5,4":containerName="iPhone 5c";break;case"iPhone6,1":containerName="iPhone 5s";break;case"iPhone6,2":containerName="iPhone 5s";break;case"iPhone7,1":containerName="iPhone 6 Plus";break;case"iPhone7,2":containerName="iPhone 6";break;case"iPod1,1":containerName="iPod Touch";break;case"iPod2,1":containerName="iPod Touch";break;case"iPod3,1":containerName="iPod Touch";break;case"iPod4,1":containerName="iPod Touch";break;case"iPod5,1":containerName="iPod Touch";break;case"iPad1,1":containerName="iPad";break;case"iPad1,2":containerName="iPad 3G";break;case"iPad2,1":containerName="iPad 2";break;case"iPad2,2":containerName="iPad 2";break;case"iPad2,3":containerName="iPad 2";break;case"iPad2,4":containerName="iPad 2";break;case"iPad2,5":containerName="iPad Mini";break;case"iPad2,6":containerName="iPad Mini";break;case"iPad2,7":containerName="iPad Mini";break;case"iPad3,1":containerName="iPad 3";break;case"iPad3,2":containerName="iPad 3";break;case"iPad3,3":containerName="iPad 3";break;case"iPad3,4":containerName="iPad 4";break;case"iPad3,5":containerName="iPad 4";break;case"iPad3,6":containerName="iPad 4";break;case"iPad4,1":containerName="iPad Air";break;case"iPad4,2":containerName="iPad Air";break;case"iPad4,3":containerName="iPad Air";break;case"iPad4,4":containerName="iPad Mini";break;case"iPad4,5":containerName="iPad Mini";break;case"iPad4,6":containerName="iPad Mini";break;case"iPad4,7":containerName="iPad Mini 3";break;case"iPad4,8":containerName="iPad Mini 3";break;case"iPad4,9":containerName="iPad Mini 3";break;case"iPad5,3":containerName="iPad Air 2";break;case"iPad5,3":containerName="iPad Air 2";break;case"i386":containerName="Simulator";break;case"x86_64":containerName="Simulator";break;default:containerName=deviceModel.substr(0,deviceModel.indexOf(",")-1)}return containerName},_clearCache:function(){return this.eventCache={}},_setEventCache:function(calendarName,events){return null==this.eventCache&&(this.eventCache={}),this.eventCache[calendarName]=JSON.stringify(events)},_getEventCache:function(calendarName){return null!=this.eventCache&&this.eventCache[calendarName]?this.eventCache[calendarName]:null},_hasNewEvents:function(calendarName,events){var ecString,eventCache,evtString;return eventCache=this._getEventCache(calendarName),null==eventCache?!0:(ecString=eventCache,evtString=JSON.stringify(events),ecString!==evtString)},_formatParticipants:function(attendees){var particpants;return particpants=[],_.each(attendees,function(attendee){var email;return email=attendee.url.replace("mailto:",""),particpants.push('"'+attendee.name+'" <'+email+">")}),particpants.join()},_findOrganizer:function(organizer,attendees){var email,orgAttendee;return orgAttendee=_.find(attendees,function(attendee){return attendee.name===organizer}),null!=orgAttendee?(email=orgAttendee.url.replace("mailto:",""),'"'+orgAttendee.name+'" <'+email+">"):null},_prepareEventsForBatchUpdate:function(events){var suggestionBatch;return suggestionBatch=[],_.each(events,function(_this){return function(event){var batchEvent,organizer;return batchEvent={},batchEvent.uid=event.calendarItemExternalIdentifier,batchEvent.title=event.title,batchEvent.begin_epoch=parseInt(event.startDateEpoch),batchEvent.end_epoch=parseInt(event.endDateEpoch),batchEvent.description=event.message,batchEvent.location=event.location,batchEvent.participant_list=_this._formatParticipants(event.attendees),organizer=_this._findOrganizer(event.organizer,event.attendees),null!=organizer&&(batchEvent.organizer=organizer),suggestionBatch.push(batchEvent)}}(this)),$log.debug("Events prepared for batch import",suggestionBatch),suggestionBatch},_batchUpdateSuggestions:function(calendarId,calendarName,isDefault,events){var sourceBatch;return sourceBatch={source_container_id:device.uuid,source_container_type:"phone",source_container_name:this._getContainerName(device.model),source_id_inside_container:calendarId,source_name:calendarName,source_is_primary:isDefault,timespan_begin_epoch:calendarService.getTimespanBeginEpoch(),timespan_end_epoch:calendarService.getTimespanEndEpoch(),suggestions:events},currentUserService.getRoute().one("suggested_meetings").post("set_for_source_batch",sourceBatch)},_prepareCalendarsForBatchUpdate:function(containerName,containerId,calendars){var suggestionSourceData;return suggestionSourceData={container_name:containerName,container_type:"phone",container_id:containerId,sources:[]},_.each(calendars,function(){return function(cal){return suggestionSourceData.sources.push({name:cal.name,id_inside_container:cal.id,is_primary:cal.defaultCalendarForNewEvents})}}(this)),suggestionSourceData},_update:function(){return $log.debug("Update suggestions"),calendarService.getDeviceCalendars().then(function(_this){return function(suggestionSources){var containerName,data,deferred;return deferred=$q.defer(),data={},data.events=[],data.updateList=[],data.suggestionSources=suggestionSources,containerName=_this._getContainerName(device.model),data.sourceContainer=_this._prepareCalendarsForBatchUpdate(containerName,device.uuid,suggestionSources),_.each(data.suggestionSources,function(suggestionSource){return data.events.push(calendarService.getEventsFromCalendar(suggestionSource))}),$q.all(data.events).then(function(suggestions){return data.suggestions=suggestions,deferred.resolve(data)}),deferred.promise}}(this)).then(function(_this){return function(data){return _.each(data.suggestions,function(suggestions){return _this._hasNewEvents(suggestions.calendar.name,suggestions.events)?($log.debug("Found new events"),data.updateList.push({id:suggestions.calendar.id,name:suggestions.calendar.name,defaultCalendarForNewEvents:suggestions.calendar.defaultCalendarForNewEvents,suggestions:_this._prepareEventsForBatchUpdate(suggestions.events),events:suggestions.events})):void 0}),data}}(this)).then(function(){return function(data){var deferred;return deferred=$q.defer(),0!==data.updateList.length&&($log.debug("Updating suggestions"),currentUserService.getRoute().one("suggestion_sources").post("set_container_batch",data.sourceContainer).then(function(){return deferred.resolve(data)})),deferred.promise}}(this)).then(function(_this){return function(data){var updates;return updates=[],_.each(data.updateList,function(batch){return updates.push(_this._batchUpdateSuggestions(batch.id,batch.name,batch.defaultCalendarForNewEvents,batch.suggestions).then(function(){return $log.debug("Update succesful, refreshing cache"),_this._setEventCache(batch.name,batch.events)}))}),$q.all(updates)}}(this))},_disconnectAndroid:function(){var deferred;return deferred=$q.defer(),CalendarConnector.stopService(function(result){return"OK"===result?CalendarConnector.removeSources(function(result){return"OK"===result?deferred.resolve():deferred.reject(result)}):deferred.reject(result)}),deferred.promise},getCalendarConnectedUsers:function(){var calendarConnected;return calendarConnected=localStorage.getItem("__calendar_connected"),calendarConnected?JSON.parse(calendarConnected):[]},setCalendarConnectedUsers:function(userIds){return localStorage.setItem("__calendar_connected",JSON.stringify(userIds))},getCalendarSuggestionsEnabled:function(){var connectedUsers;return connectedUsers=this.getCalendarConnectedUsers(),_.contains(connectedUsers,sessionService.getUserId())},enableCalendarSuggestions:function(){var connectedUsers;return $log.debug("Adding current user to enabled suggestions list"),this.getCalendarSuggestionsEnabled()?void 0:(connectedUsers=this.getCalendarConnectedUsers(),connectedUsers.push(sessionService.getUserId()),this.setCalendarConnectedUsers(connectedUsers))},disableCalendarSuggestions:function(){var connectedUsers;return $log.debug("Removing current user from enabled suggestions list"),connectedUsers=this.getCalendarConnectedUsers(),_.remove(connectedUsers,function(userId){return userId===sessionService.getUserId()}),this.setCalendarConnectedUsers(connectedUsers)},updateSources:function(user,suggestionSources){return user.source_settings=this.enableSelectedSources(suggestionSources),currentUserService.update(user)},pollForSuggestions:function(){return $log.debug("Starting calendar suggestion polling"),this.pollPromise=this.poll(function(_this){return function(){return $log.debug("Polling for calendar suggestions"),_this._update()}}(this))},stopPollingForSuggestions:function(){return $log.debug("Polling for calendar suggestions canceled"),this.cancelPoll(this.pollPromise),this.pollPromise=null},poll:function(callback){return $interval(callback,appConfig.calendar.pollInterval)},cancelPoll:function(pollPromise){return $interval.cancel(pollPromise)},syncCalendarsAndroid:function(){var deferred;return deferred=$q.defer(),CalendarConnector.startService(function(_this){return function(result){return"OK"===result?$timeout(function(){return CalendarConnector.forceUpdate(function(result){return"OK"===result?(deferred.resolve(),_this.enableCalendarSuggestions()):deferred.reject(result)})},1e3):deferred.reject(result)}}(this)),deferred.promise},syncCalendarsIOS:function(){return this._clearCache(),this._update().then(function(_this){return function(){return _this.pollForSuggestions(),_this.enableCalendarSuggestions()}}(this))},syncCalendars:function(){return"ios"===deviceUtils.platform()?this.syncCalendarsIOS():"android"===deviceUtils.platform()?this.syncCalendarsAndroid():void 0},disconnectDeviceCalendar:function(containerName,containerId,isCurrentDevice,platform){var suggestionSourceData;return isCurrentDevice&&"android"===platform?(this.disableCalendarSuggestions(),this._disconnectAndroid()):(isCurrentDevice&&"ios"===platform&&(this.disableCalendarSuggestions(),this.stopPollingForSuggestions(),this._clearCache()),suggestionSourceData=this._prepareCalendarsForBatchUpdate(containerName,containerId,[]),currentUserService.getRoute().one("suggestion_sources").post("set_container_batch",suggestionSourceData).then(function(){return function(data){return $log.debug("set_container_batch succesful",data)}}(this),function(){return function(failure){return $log.debug("set_container_batch failed",failure)}}(this)))},enableSelectedSources:function(suggestionSources){var disabled,enabled;return enabled={},disabled={},_.each(suggestionSources,function(source){source.selected_by_default?enabled[source.uid]=1:disabled[source.uid]=1}),{enabled:enabled,disabled:disabled}},selectDefaultSources:function(suggestionSources){return _.each(suggestionSources,function(source){source.selected_by_default=1===source.selected_by_default}),suggestionSources},selectEnabledSources:function(suggestionSources,sourceSettings){return _.each(suggestionSources,function(source){source.selected_by_default=1===source.selected_by_default,null!=sourceSettings.enabled[source.uid]&&(source.selected_by_default=!0),null!=sourceSettings.disabled[source.uid]&&(source.selected_by_default=!1)}),suggestionSources},isCurrentDeviceCalendarConnected:function(suggestionSources){return _.where(suggestionSources,{container_id:device.uuid}).length>0}}});var UAService,urbanAirshipModule,bind=function(fn,me){return function(){return fn.apply(me,arguments)}};UAService=function(){function UAService(log,timeout,appConfig,deviceready,jsonMsgChannel,currentUserService,sessionService){this.log=log,this.timeout=timeout,this.appConfig=appConfig,this.deviceready=deviceready,this.jsonMsgChannel=jsonMsgChannel,this.currentUserService=currentUserService,this.sessionService=sessionService,this._onRegistration=bind(this._onRegistration,this),this._onPushReceived=bind(this._onPushReceived,this),this._onLaunchedFromPush=bind(this._onLaunchedFromPush,this)}return UAService.$inject=["$log","$timeout","appConfig","deviceready","jsonMsgChannel","currentUserService","sessionService"],UAService.prototype._onLaunchedFromPush=function(notification){return notification.message?(this.log.debug("[UA] Got incoming push notification, opening notification page",notification),this.jsonMsgChannel.publish(JSON.stringify({event:"openNotification",notification:{message:notification.message,extras:notification.extras}}))):void 0},UAService.prototype._onPushReceived=function(notification){var ref;return this.log.debug("[UA] Got incoming push notification",notification),null!=(null!=(ref=notification.extras)?ref.push_test:void 0)?void this._setDevicePushStatus(1):notification.message?(this.jsonMsgChannel.publish(JSON.stringify({event:"fetchNotifications"})),this.jsonMsgChannel.publish(JSON.stringify({event:"newNotification",notification:{message:notification.message,extras:notification.extras}}))):void 0},UAService.prototype._onRegistration=function(result){return this.log.debug("[UA] Registration result",result)},UAService.prototype._setEnabled=function(enabled){return UAirship.setUserNotificationsEnabled(enabled,function(_this){return function(result){return _this.log.debug("[UA] setUserNotificationsEnabled result",result)}}(this))},UAService.prototype._sendTestPush=function(){return this.sessionService.isSignedIn()?this.testPushCounter<this.appConfig.pushNotifications.testPushRetryCount?this.currentUserService.sendTestPush(this.channelID).then(function(_this){return function(){return _this.log.debug("[UA] Sent test push succesfully"),_this.testPushTimeout=_this.timeout(function(){return _this.log.debug("[UA] Retrying test push"),++_this.testPushCounter,_this._sendTestPush()},_this.appConfig.pushNotifications.testPushRetryInterval)}}(this),function(_this){return function(failure){return _this.log.debug("[UA] Failed to send test push",failure),_this.testPushTimeout=_this.timeout(function(){return _this.log.debug("[UA] Retrying test push"),++_this.testPushCounter,_this._sendTestPush()},_this.appConfig.pushNotifications.testPushRetryInterval)}}(this)):this._setDevicePushStatus(0):void 0},UAService.prototype._setDevicePushStatus=function(status){return this.sessionService.isSignedIn()?(this.timeout.cancel(this.testPushTimeout),this.currentUserService.setDevicePushStatus(this.channelID,status).then(function(_this){return function(data){return _this.log.debug("[UA] Device push status set succesfully",data)}}(this),function(_this){return function(failure){return _this.log.debug("[UA] Setting device push status failed",failure),status=0}}(this))["finally"](function(_this){return function(){return _this.pushNotificationStatus=status,_this.jsonMsgChannel.publish(JSON.stringify({event:"pushNotificationStatusChanged",status:status}))}}(this))):void 0},UAService.prototype.init=function(){return this.deviceready.then(function(_this){return function(){return _this.testPushCounter=0,document.addEventListener("urbanairship.registration",_this._onRegistration,!1),document.addEventListener("urbanairship.push",_this._onPushReceived,!1),document.addEventListener("pause",function(){return document.removeEventListener("urbanairship.registration",_this._onRegistration,!1),document.removeEventListener("urbanairship.push",_this._onPushReceived,!1)},!1),document.addEventListener("resume",function(){return UAirship.resetBadge(),UAirship.getLaunchNotification(!0,_this._onLaunchedFromPush),document.addEventListener("urbanairship.registration",_this._onRegistration,!1),document.addEventListener("urbanairship.push",_this._onPushReceived,!1)},!1),UAirship.getLaunchNotification(!0,_this._onLaunchedFromPush),UAirship.isUserNotificationsEnabled(function(enabled){return enabled?_this.log.debug("[UA] Push was already enabled"):(_this.log.debug("[UA] Push is not enabled, enabling now"),_this._setEnabled(!0))}),UAirship.getChannelID(function(channelID){return _this.channelID=channelID})}}(this))},UAService.prototype.setAlias=function(alias){return UAirship.setAlias(alias,function(_this){return function(){return _this.log.debug("[UA] Set alias to",alias),_this._sendTestPush(),_this.jsonMsgChannel.publish(JSON.stringify({event:"UAregistrationSuccess"}))}}(this))},UAService.prototype.setBadgeNumber=function(badge){return badge>0?UAirship.setBadgeNumber(badge):UAirship.resetBadge()},UAService.prototype.clearNotifications=function(){return UAirship.clearNotifications(function(_this){return function(result){return _this.log.debug("Notifications cleared",result)}}(this))},UAService.prototype.testPushNotifications=function(){return this.testPushCounter=0,this._sendTestPush()},UAService}(),urbanAirshipModule=angular.module("urbanAirshipModule",["appConfig","mtnUtils","MsgChannel","currentUserModule","sessionModule"]),urbanAirshipModule.service("urbanAirshipService",UAService);
var viewParams;viewParams=angular.module("viewParams",["ngRoute"]),viewParams.service("viewParams",function($routeParams){return{get:function(key){var value;return value=null,null!=this.viewParams&&(value=this.viewParams[key]),null==value&&(value=$routeParams[key]),null==value||_.isObject(value)||(value=decodeURIComponent(value)),value},add:function(key,value){return null==this.viewParams&&(this.viewParams={}),this.viewParams[key]=value},remove:function(key){return null!=this.viewParams?delete this.viewParams[key]:void 0},set:function(object){return this.viewParams=object}}});var msgChannel,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},slice=[].slice,extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;msgChannel=angular.module("MsgChannel",[]),msgChannel.factory("MsgChannel",function($rootScope){var Channel;return Channel=function(){function Channel(name){this.name=name,this.subscribe=bind(this.subscribe,this),this.publishTo=bind(this.publishTo,this),this.publish=bind(this.publish,this),this.eventListeners=[]}return Channel.prototype._msgChannelEventCallback=function(msg,listener){switch(msg.data.channel){case this.name:return listener(this.parseMsg.apply(this,msg.data.args))}},Channel.prototype.parseMsg=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[]},Channel.prototype.publish=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],$rootScope.$emit(this.name,{args:args})},Channel.prototype.publishTo=function(){var args,msgChannel;return msgChannel=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[],$rootScope.$emit(msgChannel,{args:args})},Channel.prototype.subscribe=function(listener){return this.eventListeners.push($rootScope.$on(this.name,function(_this){return function(event,msg){return listener(_this.parseMsg.apply(_this,msg.args))}}(this)))},Channel.prototype.unsubscribe=function(){return _.eachRight(this.eventListeners,function(eventListener,i,listeners){return eventListener(),listeners.splice(i,1)})},Channel}()}),msgChannel.factory("JsonMsgChannel",function(MsgChannel,$log){var JsonMsgChannel;return JsonMsgChannel=function(superClass){function JsonMsgChannel(){return JsonMsgChannel.__super__.constructor.apply(this,arguments)}return extend(JsonMsgChannel,superClass),JsonMsgChannel.prototype.parseMsg=function(msg){var error,error1;try{return JSON.parse(msg)}catch(error1){return error=error1,$log.warn("[JsonMsgChannel "+this.name+"] received invalid json -- ",error)}},JsonMsgChannel}(MsgChannel)}),msgChannel.factory("jsonMsgChannel",function(JsonMsgChannel){return new JsonMsgChannel("commonMsgChannel")});var SPARouteConfig;SPARouteConfig=angular.module("SPARouteConfig",["ngRoute","appConfig"]),SPARouteConfig.run(function($rootScope,$window,$route,$location){var isViewAnimationDisabled,onPathChange;return $rootScope.stackPosition=0,isViewAnimationDisabled=function(oldLocation,newLocation){var locationRegExp,newL,oldL,tabs;return tabs=["scheduling","timeline","notifications","settings","styleguide"],locationRegExp=new RegExp("^/("+tabs.join("|")+")/?.*$"),oldL=oldLocation.replace(locationRegExp,"$1"),newL=newLocation.replace(locationRegExp,"$1"),oldL!==newL},onPathChange=function(newLocation,oldLocation){var back,elem,historyState;return $rootScope.disableViewAnimation=isViewAnimationDisabled(oldLocation,newLocation),elem=angular.element(document.getElementsByClassName("spa-page")),$rootScope.actualLocation===newLocation?(historyState=$window.history.state,back=!!(historyState&&historyState.position<=$rootScope.stackPosition),back?($rootScope.stackPosition--,elem.addClass("spa-page-back"),elem.removeClass("spa-page-forward")):($rootScope.stackPosition++,elem.removeClass("spa-page-back"),elem.addClass("spa-page-forward"))):$route.current?($window.history.replaceState({position:$rootScope.stackPosition},"",""),$rootScope.stackPosition++,elem.removeClass("spa-page-back"),elem.addClass("spa-page-forward")):void 0},$rootScope.$on("$locationChangeStart",function(){return $rootScope.actualLocation=$location.path()}),$rootScope.$watch(function(){return $location.path()},onPathChange)}),SPARouteConfig.config(["$routeProvider","appConfigProvider",function($routeProvider){return $routeProvider.when("/timeline",{templateUrl:"/views/meeting/_timeline.html",controller:"MeetingIndexCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId",{templateUrl:"/views/meeting/_meeting.html",controller:"MeetingShowCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/edit/:editing",{templateUrl:"/views/meeting/_edit.html",controller:"MeetingEditCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/controls",{templateUrl:"/views/meeting/_controls.html",controller:"MeetingControlsCtrl as controls",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/log",{templateUrl:"/views/scheduling/_log.html",controller:"SchedulingLogCtrl as log",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/participants",{templateUrl:"/views/participant/_participantlist.html",controller:"ParticipantIndexCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/participants/add",{templateUrl:"/views/participant/_new.html",controller:"ParticipantNewCtrl as new",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/participants/invitation",{templateUrl:"/views/participant/_invitation.html",controller:"ParticipantDraftInvitationCtrl as invitation",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/participants/:participantId",{templateUrl:"/views/participant/_participantshow.html",controller:"ParticipantShowCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/material/:materialId",{templateUrl:"/views/material/_show.html",controller:"MaterialShowCtrl as show",reloadOnSearch:!1}).when("/notifications",{templateUrl:"/views/notification/_notifications.html",controller:"NotificationIndexCtrl as index",reloadOnSearch:!1}).when("/notifications/:notificationId",{templateUrl:"/views/notification/_customNotification.html",controller:"NotificationCustomCtrl as show",reloadOnSearch:!1}).when("/settings",{templateUrl:"/views/menu/_menu.html",controller:"MenuIndexCtrl as index",reloadOnSearch:!1}).when("/settings/profile",{templateUrl:"/views/profile/_profile.html",controller:"ProfileEditCtrl as edit",reloadOnSearch:!1}).when("/settings/notifications",{templateUrl:"/views/menu/_notificationSettings.html",controller:"MenuNotificationSettingsCtrl as index",reloadOnSearch:!1}).when("/settings/notifications/email",{templateUrl:"/views/menu/_notifications.html",controller:"MenuEmailNotificationCtrl as index",reloadOnSearch:!1}).when("/settings/notifications/push",{templateUrl:"/views/menu/_notifications.html",controller:"MenuPushNotificationCtrl as index",reloadOnSearch:!1}).when("/settings/calendars",{templateUrl:"/views/menu/_accountSettings.html",controller:"MenuAccountSettingsCtrl as index",reloadOnSearch:!1}).when("/settings/timeline",{templateUrl:"/views/menu/_calendarSettings.html",controller:"MenuCalendarSettingsCtrl as index",reloadOnSearch:!1}).when("/settings/regional",{templateUrl:"/views/menu/_regionalSettings.html",controller:"MenuRegionalSettingsCtrl as index",reloadOnSearch:!1}).when("/:tab/starttrial",{templateUrl:"/views/trial/_startTrial.html",controller:"TrialIndexCtrl as index",reloadOnSearch:!1}).when("/scheduling",{templateUrl:"/views/scheduling/_newScheduling.html",controller:"SchedulingIndexCtrl as index",reloadOnSearch:!1}).when("/:tab/time",{templateUrl:"/views/scheduling/_time.html",controller:"SchedulingTimeCtrl as index",reloadOnSearch:!1}).when("/:tab/customtime",{templateUrl:"/views/scheduling/_edit-time.html",controller:"SchedulingEditTimeCtrl as index",reloadOnSearch:!1}).when("/:tab/duration",{templateUrl:"/views/scheduling/_duration.html",controller:"SchedulingDurationCtrl as index",reloadOnSearch:!1}).when("/:tab/customduration",{templateUrl:"/views/scheduling/_edit-duration.html",controller:"SchedulingEditDurationCtrl as index",reloadOnSearch:!1}).when("/:tab/location",{templateUrl:"/views/scheduling/_location.html",controller:"SchedulingLocationCtrl as index",reloadOnSearch:!1}).when("/:tab/customlocation",{templateUrl:"/views/scheduling/_edit-location.html",controller:"SchedulingEditLocationCtrl as index",reloadOnSearch:!1}).when("/:tab/participants",{templateUrl:"/views/scheduling/_select-participants.html",controller:"SchedulingParticipantsCtrl as index",reloadOnSearch:!1}).when("/:tab/review",{templateUrl:"/views/scheduling/_review.html",controller:"SchedulingReviewCtrl as index",reloadOnSearch:!1}).when("/:tab/timespan",{templateUrl:"/views/scheduling/_edit-date.html",controller:"SchedulingEditTimespanCtrl as index",reloadOnSearch:!1}).when("/:tab/calendars",{templateUrl:"/views/scheduling/_edit-sources.html",controller:"SchedulingEditSourcesCtrl as index",reloadOnSearch:!1}).when("/:tab/material",{templateUrl:"/views/material/_show.html",controller:"MaterialShowCtrl as show",reloadOnSearch:!1}).when("/:tab/done",{templateUrl:"/views/scheduling/_done.html",controller:"SchedulingStartCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling",{templateUrl:"/views/scheduling/_newScheduling.html",controller:"SchedulingIndexCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/review",{templateUrl:"/views/scheduling/_review.html",controller:"SchedulingReviewCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId",{templateUrl:"/views/swipetomeet/_swipeLanding.html",controller:"SwipeToMeetLandingCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/suggestions",{templateUrl:"/views/swipetomeet/_swipeSuggestions.html",controller:"SwipeToMeetShowCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/suggestions/connectCalendar",{templateUrl:"/views/swipetomeet/_accountSettings.html",controller:"MenuAccountSettingsCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/suggestions/selectsources",{templateUrl:"/views/menu/_calendarSettings.html",controller:"MenuCalendarSettingsCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/suggestions/info/:optionId",{templateUrl:"/views/swipetomeet/_swipeInfo.html",controller:"SwipeToMeetInfoCtrl as info",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/thanks/:thanksMsg",{templateUrl:"/views/swipetomeet/_swipeThanks.html",controller:"SwipeToMeetThanksCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/countryCode",{templateUrl:"/views/swipetomeet/_countryCode.html",controller:"SwipeToMeetCountryCodeCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/confirmPhone",{templateUrl:"/views/swipetomeet/_confirmPhone.html",controller:"SwipeToMeetConfirmPhoneCtrl as show",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/appDownloadGuide",{templateUrl:"/views/swipetomeet/_appDownloadGuide.html",controller:"SwipeToMeetAppDownloadGuideCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/leave/confirm",{templateUrl:"/views/swipetomeet/_confirmLeaveScheduling.html",controller:"SwipeToMeetConfirmLeaveCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/leave/invitesubstitute",{templateUrl:"/views/swipetomeet/_inviteSubstitute.html",controller:"SwipeToMeetInviteSubsituteCtrl as index",reloadOnSearch:!1}).when("/:tab/meeting/:meetingId/scheduling/:schedulingId/leave",{templateUrl:"/views/swipetomeet/_leaveScheduling.html",controller:"SwipeToMeetLeaveCtrl as index",reloadOnSearch:!1}).when("/styleguide",{templateUrl:"/views/styleguide/_index.html",controller:"StyleguideIndexCtrl as index",reloadOnSearch:!1}).when("/signin",{templateUrl:"/views/initial/_signinPhone.html",controller:"SignInIndexCtrl as signIn"}).when("/signin/country",{templateUrl:"/views/initial/_signinCountry.html",controller:"SignInCountryCodeCtrl as signIn"}).when("/signin/pin",{templateUrl:"/views/initial/_signinPin.html",controller:"SignInPinCtrl as signIn"}).when("/signup",{templateUrl:"/views/initial/_signup.html",controller:"SignUpCtrl as signUp"}).when("/signup/pin",{templateUrl:"/views/initial/_signupPin.html",controller:"SignUpPinCtrl as signUp"}).when("/signup/profileimage",{templateUrl:"/views/initial/_profileImage.html",controller:"ProfileImageUploadCtrl as profile"}).when("/signup/calendarConnect",{templateUrl:"/views/initial/_calendarConnect.html",controller:"CalendarConnectCtrl as calendarConnect"}).when("/signup/initPushNotifications",{templateUrl:"/views/initial/_initPushNotifications.html",controller:"InitPushNotificationsCtrl as initPushNotifications"}).when("/appStoreRedirect",{templateUrl:"/views/appstoreredirect/_index.html",controller:"AppStoreRedirectCtrl as index"}).otherwise({redirectTo:"undefined"!=typeof cordova&&null!==cordova?"/scheduling":"/timeline"})}]);var appConfig;appConfig=angular.module("appConfig",["angulartics","angulartics.segment.io","ngSanitize","pageWrapper","epochToMoment","mtnAutofocus","mtnAvatar","mtnUtils","breadcrumb","analytics","sentryModule","materialModule","sessionModule","MsgChannel","currentUserModule","navigationBarModule","viewParams","cacheModule"]),appConfig.constant("appName",mtnApp.appName),appConfig.constant("appVersion",mtnApp.version),appConfig.constant("appEnvironment",mtnApp.config.environment),appConfig.constant("appMode",mtnApp.config.mode),appConfig.constant("socialMedia",{"Meetin.gs":{facebookPageId:0xa65ae0f9fa52,twitterId:252745045},SwipeToMeet:{facebookPageId:736185226466841,twitterId:2976255909},cMeet:{facebookPageId:0,twitterId:0}}),appConfig.provider("appSettings",function(socialMedia,appName){return{appSettings:{"Meetin.gs":{socialMedia:socialMedia[appName],supportLinks:{support:{linkText:"Send feedback",url:"mailto:feedback@swipetomeet.com?subject=SwipeToMeet%20feedback",alternativeUrl:"mailto:feedback@swipetomeet.com?subject=SwipeToMeet%20feedback"},facebook:{linkText:"Meetin.gs on Facebook",url:"fb://"+("ios"===("undefined"!=typeof device&&null!==device?device.platform.toLowerCase():void 0)?"profile":"page")+"/"+socialMedia[appName].facebookPageId,alternativeUrl:"https://www.facebook.com/www.meetin.gs"},twitter:{linkText:"Meetin.gs on Twitter",url:"twitter://user?user_id="+socialMedia[appName].twitterId,alternativeUrl:"https://twitter.com/meetin_gs"}}},SwipeToMeet:{socialMedia:socialMedia[appName],supportLinks:{support:{linkText:"Send feedback",url:"mailto:feedback@swipetomeet.com?subject=SwipeToMeet%20feedback",alternativeUrl:"mailto:feedback@swipetomeet.com?subject=SwipeToMeet%20feedback"},facebook:{linkText:"SwipeToMeet on Facebook",url:"fb://"+("ios"===("undefined"!=typeof device&&null!==device?device.platform.toLowerCase():void 0)?"profile":"page")+"/"+socialMedia[appName].facebookPageId,alternativeUrl:"https://www.facebook.com/swipetomeet"},twitter:{linkText:"SwipeToMeet on Twitter",url:"twitter://user?user_id="+socialMedia[appName].twitterId,alternativeUrl:"https://twitter.com/swipetomeet"}}},cMeet:{socialMedia:socialMedia[appName],supportLinks:{support:{linkText:"",url:"",alternativeUrl:""},facebook:{linkText:"",url:"",alternativeUrl:""},twitter:{linkText:"",url:"",alternativeUrl:""}}}},$get:function(){return this.appSettings}}}),appConfig.provider("appEnvironments",function(){return{appEnvironments:_.extend(window.appEnvironments,{commons:{timeline:{initialMeetingsLimit:20,fetchMoreMeetingsLimit:10},meeting:{participants:{maxCountBeforeSummary:7}},thumbnail:{small:64,medium:120,large:200},notifications:{pollInterval:3e5},calendar:{pollInterval:6e5},scheduling:{pollInterval:500},pushNotifications:{testPushRetryCount:10,testPushRetryInterval:5e3},tabIndex:{scheduling:0,timeline:1,notification:2,menu:3},tabs:[{location:"http://localhost/views/scheduling/index.html#/scheduling/"},{location:"http://localhost/views/meeting/index.html?msgChannel=timeline"},{location:"http://localhost/views/notification/index.html?msgChannel=notifications"},{location:"http://localhost/views/menu/index.html?msgChannel=menu"}],appStoreUrls:{ios:"https://itunes.apple.com/en/app/swipetomeet/id996409597",android:"https://play.google.com/store/apps/details?id=com.swipetomeet.mobile"}}}),$get:function(){return this.appEnvironments}}}),appConfig.provider("appConfig",function(appEnvironmentsProvider,appSettingsProvider,appEnvironment,appMode,appVersion,appName){var accessors,appEnvironments,appSettings,commons;return accessors={isDevelopmentMode:"development"===appMode,isBetaEnvironment:"beta"===appEnvironment||"alpha"===appEnvironment,environment:appEnvironment,version:appVersion,appName:appName},appEnvironments=appEnvironmentsProvider.appEnvironments[appEnvironment],commons=appEnvironmentsProvider.appEnvironments.commons,appSettings=appSettingsProvider.appSettings[appName],{appConfig:_.extend(appEnvironments,commons,accessors,appSettings),$get:function(){return this.appConfig}}}),appConfig.config(function($analyticsProvider){return $analyticsProvider.virtualPageviews(!1)}),appConfig.config(["$compileProvider",function($compileProvider){return $compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|tel|mailto|skype|sip|sips):/)}]),appConfig.config(function($logProvider,appMode){return"production"===appMode?$logProvider.debugEnabled(!1):void 0});var breadcrumb;breadcrumb=angular.module("breadcrumb",[]),breadcrumb.factory("breadcrumb",function(){return{set:function(title,clickable){return null!=title?(localStorage.setItem("breadcrumb",title),localStorage.setItem("breadcrumbClickable",clickable)):(title=localStorage.getItem("breadcrumb"),clickable="undefined"!==localStorage.getItem("breadcrumbClickable")?localStorage.getItem("breadcrumbClickable"):void 0),this.title=decodeURIComponent(title),this.clickable=clickable}}});var meetingGroupUtils;meetingGroupUtils=angular.module("meetingGroupUtils",["dateHelper"]),meetingGroupUtils.factory("meetingGroupUtils",function(dateHelper,groupAndFilter){return{groupMeetings:function(ungroupedMeetings){var meetings;return meetings={},meetings.today=groupAndFilter(ungroupedMeetings,!0,function(){return function(m){return dateHelper.isEpochToday(m.begin_epoch)}}(this)),meetings.thisWeekUpcoming=groupAndFilter(ungroupedMeetings,!0,function(){return function(m){return dateHelper.isEpochThisWeekInFuture(m.begin_epoch)}}(this)),meetings.nextWeek=groupAndFilter(ungroupedMeetings,!0,function(){return function(m){return dateHelper.isEpochNextWeek(m.begin_epoch)}}(this)),meetings.furtherInFuture=groupAndFilter(ungroupedMeetings,!0,function(){return function(m){return dateHelper.isEpochFurtherInFuture(m.begin_epoch,7)&&!dateHelper.isEpochNextWeek(m.begin_epoch)}}(this)),meetings.yesterday=groupAndFilter(ungroupedMeetings,!1,function(){return function(m){return dateHelper.isEpochYesterday(m.begin_epoch)}}(this)),meetings.thisWeekBefore=groupAndFilter(ungroupedMeetings,!1,function(){return function(m){return dateHelper.isEpochThisWeekInPast(m.begin_epoch)&&!dateHelper.isEpochYesterday(m.begin_epoch)}}(this)),meetings.lastWeek=groupAndFilter(ungroupedMeetings,!1,function(){return function(m){return dateHelper.isEpochLastWeek(m.begin_epoch)}}(this)),meetings.furtherInPast=groupAndFilter(ungroupedMeetings,!1,function(){return function(m){return dateHelper.isEpochFurtherInPast(m.begin_epoch,7)&&!dateHelper.isEpochLastWeek(m.begin_epoch)}}(this)),meetings.unscheduled=_(ungroupedMeetings).filter(function(){return function(m){return dateHelper.isEpochUnset(m.begin_epoch)}}(this)).groupBy("title").map().value(),meetings}}}),meetingGroupUtils.factory("groupAndFilter",function(){return function(meetings,sortOrder,filter){return _(meetings).filter(filter).sortByOrder(["begin_epoch"],[sortOrder]).groupBy("date_string").map().value()}});var mtnQbaka;mtnQbaka=angular.module("mtnQbaka",["appConfig"]),mtnQbaka.run(function(appConfig,sessionService){return appConfig.qbaka.enabled?(window.qbaka.key=appConfig.qbaka.key,window.qbaka.user=sessionService.isSignedIn()?sessionService.getUserId():"signed out",window.qbaka("param","version",appConfig.version)):void 0}),mtnQbaka.factory("$exceptionHandler",function($log){return function(exception){return qbaka.report(exception),$log.error(exception)}}),mtnQbaka.directive("mtnQbakaReport",function(appConfig){return{restrict:"A",scope:{mtnQbakaReport:"="},link:function(scope,elem){return elem.parent().parent()[0].style.display="none",appConfig.qbaka.enabled?window.qbaka.report("Unknown notification type: "+scope.mtnQbakaReport):void 0}}});var session;session=angular.module("SessionModel",["restangular","appConfig","mtnUtils"]),session.run(function(Restangular,appConfig){return Restangular.setBaseUrl(appConfig.api.baseUrl)}),session.config(function(RestangularProvider){return RestangularProvider.setDefaultHttpFields({timeout:2e4}),RestangularProvider.setResponseInterceptor(function(data,operation,what,url,response,deferred){return!data||data.error?deferred.reject(data):deferred.resolve(data),data}),RestangularProvider.setResponseExtractor(function(response){var newResponse;return newResponse=response,angular.isArray(response)?angular.forEach(newResponse,function(value,key){return newResponse[key].originalElement=angular.copy(value)}):newResponse.originalElement=angular.copy(response),newResponse})}),session.factory("SessionRestangular",function(appConfig,Restangular,sessionService,deviceUtils){return this.sessionRestangular=Restangular.withConfig(function(RestangularConfigurer){return RestangularConfigurer.setDefaultHeaders({user_id:sessionService.getUserId(),dic:sessionService.getToken(),"x-meetings-app-version":appConfig.version+" "+appConfig.appName+" "+deviceUtils.platform(),"x-expect-http-errors-for-rest":1,"x-expect-int-epochs":1})}),this.sessionRestangular.refreshDefaultHeaders=function(_this){return function(){return _this.sessionRestangular.setDefaultHeaders({user_id:sessionService.getUserId(),dic:sessionService.getToken(),"x-meetings-app-version":appConfig.version+" "+appConfig.appName+" "+deviceUtils.platform(),"x-expect-http-errors-for-rest":1,"x-expect-int-epochs":1})}}(this),this.sessionRestangular}),session.factory("AuthenticationRestangular",function(appConfig,Restangular,deviceUtils){var authenticationRestangular;return authenticationRestangular=Restangular.withConfig(function(RestangularConfigurer){return RestangularConfigurer.setDefaultHeaders({"x-meetings-app-version":appConfig.version+" "+appConfig.appName+" "+deviceUtils.platform(),"x-expect-int-epochs":1})})}),session.factory("LocalDataRestangular",function(appConfig,Restangular){return Restangular.withConfig(function(RestangularConfigurer){return RestangularConfigurer.setBaseUrl("data"),RestangularConfigurer.setRequestSuffix(".json")})});var mtnUtils;mtnUtils=angular.module("mtnUtils",["dateHelper"]),mtnUtils.service("deviceready",function($q){var deferred;return deferred=$q.defer(),document.addEventListener("deviceready",function(){return deferred.resolve()},!1),("undefined"==typeof cordova||null===cordova)&&deferred.resolve(),deferred.promise}),mtnUtils.factory("stringUtils",function(){return{generateRandomString:function(strLength){var i,possible,text;for(text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;strLength>i;)text+=possible.charAt(Math.floor(Math.random()*possible.length)),i++;return text},stripHtml:function(str){return null==str?"":str.replace(/<\/?[^>]+>/gi,"")},lineBreakToBr:function(str){return null==str?"":str.replace(/\n/gi,"<br />")}}}),mtnUtils.factory("cssClassUtils",function(){return{calculateAvatarBgClassName:function(md5){var bgColorCount;return null==md5?"":(bgColorCount=10,"avatar-bg-"+parseInt(md5.substring(0,6),16)%bgColorCount)}}}),mtnUtils.factory("vsprintfUtils",function(cssClassUtils,dateHelper){return{formatIconHtml:function(paramData){return'<i class="icon icon-'+paramData+'"></i>'},formatNameHtml:function(paramData){return"<span>"+paramData.name+"</span>"},formatFirstNameHtml:function(paramData){return"<span>"+paramData.first_name+"</span>"},formatAvatarInitialsHtml:function(paramData){return'<div class="avatar log-avatar '+cssClassUtils.calculateAvatarBgClassName(paramData.user_id_md5)+'"> <span class="avatar-initials">'+paramData.initials+"</span> </div>"},formatAvatarImageHtml:function(paramData){return'<div class="avatar log-avatar '+cssClassUtils.calculateAvatarBgClassName(paramData.user_id_md5)+'"> <img src="'+paramData.image+'" class="avatar-img" title="'+paramData.name+'" alt="'+paramData.name+'" /> </div>'},formatAvatarHtml:function(paramData){return paramData.image?this.formatAvatarImageHtml(paramData):this.formatAvatarInitialsHtml(paramData)},formatAvatarNameHtml:function(paramData){return this.formatAvatarHtml(paramData)+" "+this.formatNameHtml(paramData)},formatAvatarFirstNameHtml:function(paramData){return this.formatAvatarHtml(paramData)+" "+this.formatFirstNameHtml(paramData)},formatShortTimestampHtml:function(paramData){return moment.unix(paramData.epoch).format(dateHelper.formatTimeDate)},formatLongTimestampHtml:function(paramData){return moment.unix(paramData.epoch).format(dateHelper.formatTimeDayDate)},formatParams:function(item){var params;return params=[],_.each(item.params,function(_this){return function(param){var formattedParam;switch(formattedParam="",param.type){case"icon":formattedParam=_this.formatIconHtml(param.data);break;case"user":switch(param.display_hint){case"name":formattedParam=_this.formatNameHtml(param.data);break;case"first_name":formattedParam=_this.formatFirstNameHtml(param.data);break;case"avatar":formattedParam=_this.formatAvatarHtml(param.data);break;default:formattedParam=_this.formatAvatarFirstNameHtml(param.data)}break;case"timestamp":switch(param.display_hint){case"short":formattedParam=_this.formatShortTimestampHtml(param.data);break;default:formattedParam=_this.formatLongTimestampHtml(param.data)}break;case"string":formattedParam=param.data}switch(param.render_hint){case"strong":formattedParam="<strong>"+formattedParam+"</strong>";break;case"em":formattedParam="<em>"+formattedParam+"</em>"}return params.push(formattedParam)}}(this)),params}}}),mtnUtils.factory("uncacheableUrl",function(){return function(url){return url?url+"?"+(new Date).getTime():null}}),mtnUtils.factory("deviceUtils",function($log){return{isIPad:function(){return/iPad/.test(navigator.userAgent)},isIos:function(){return/iP(hone|od|ad)/.test(navigator.userAgent)},isAndroid:function(){return/android/.test(navigator.userAgent.toLowerCase())},platform:function(){return window.mtnApp.fake_platform?(window.device||($log.debug("Faking platform ",window.mtnApp.fake_platform),window.device={}),window.mtnApp.fake_platform):"undefined"==typeof cordova||null===cordova?"web":device.platform.toLowerCase()},uuid:function(){return window.mtnApp.fake_platform?($log.debug("Faking uuid for ",window.mtnApp.fake_platform),"fake uuid"):"undefined"==typeof cordova||null===cordova?"web":device.uuid},version:function(){return"undefined"==typeof cordova||null===cordova?"web":parseFloat(device.version)}}}),mtnUtils.factory("removeTinyMCE",function(){return function(id){return document.getElementById("dummybutton").focus(),tinyMCE.get(id).destroy()}}),mtnUtils.factory("javascriptUtils",function(){return{capitalizeFirstLetter:function(string){return string.charAt(0).toUpperCase()+string.slice(1)},vendorPrefix:function(element,property,argument){return element.style["ms"+this.capitalizeFirstLetter(property)]=argument,element.style["webkit"+this.capitalizeFirstLetter(property)]=argument,element.style["Moz"+this.capitalizeFirstLetter(property)]=argument,element.style["O"+this.capitalizeFirstLetter(property)]=argument,element.style[property]=argument},vendorPrefixAttr:function(element,property,argument){return element.style["ms"+this.capitalizeFirstLetter(property)]="-ms-"+argument,element.style["webkit"+this.capitalizeFirstLetter(property)]="-webkit-"+argument,element.style["Moz"+this.capitalizeFirstLetter(property)]="-moz-"+argument,element.style["O"+this.capitalizeFirstLetter(property)]="-o-"+argument,this.vendorPrefix(element,property,argument)},parseQueryString:function(queryString){var queryArray,queryParams;return queryArray=queryString.split("&"),queryParams={},_.each(queryArray,function(q){var e,error,item,key,value;item=q.split("="),key=item[0];try{value=JSON.parse(item[1])}catch(error){e=error,value=item[1]}return queryParams[key]=value}),queryParams}}});var mtnListFilters;mtnListFilters=angular.module("mtnListFilters",[]),mtnListFilters.filter("remove",function(){return function(list,removedItem){return list?(_.remove(list,function(item){return item===removedItem}),list):void 0}}),mtnListFilters.filter("difference",function(){return function(list,removedItems){return list?list=_.difference(list,removedItems):void 0}});var materialFilters;materialFilters=angular.module("materialFilters",["dateHelper"]),materialFilters.filter("filterMaterials",function(){return function(materials){return materials?_.filter(materials,function(material){return"other"!==material.material_class}):void 0}}),materialFilters.filter("filterAttachments",function(){return function(materials){return materials?_.filter(materials,function(material){return"other"===material.material_class}):void 0}});var mtnUnsafeFilter;mtnUnsafeFilter=angular.module("mtnUnsafeFilter",[]),mtnUnsafeFilter.filter("unsafe",function($sce){return $sce.trustAsHtml});var AngularInjectorMixin;AngularInjectorMixin={getAngularInjector:function(){return angular.element(document.querySelector("#reactComponentParent")).injector()}};var meetingComponents;meetingComponents=angular.module("meetingComponents",["ngRoute","react","appConfig","dateHelper","participantModule","sessionModule"]),meetingComponents.factory("Timeline",function($location,appConfig,dateHelper,participantService,sessionService){return React.createClass({displayName:"Timeline",propTypes:{allMeetings:React.PropTypes.object.isRequired,openOrSuggest:React.PropTypes.func.isRequired,createSuggested:React.PropTypes.func.isRequired,confirmHideSuggested:React.PropTypes.func.isRequired,switchTab:React.PropTypes.func.isRequired},switchTab:function(tab){return this.setState({tab:tab}),this.props.switchTab(tab)},getInitialState:function(){return{tab:$location.search().tab||"upcoming"}},componentWillMount:function(){return this.ng={appConfig:appConfig,dateHelper:dateHelper,participantService:participantService,sessionService:sessionService},this.ngCallbacks={openOrSuggest:this.props.openOrSuggest,createSuggested:this.props.createSuggested,confirmHideSuggested:this.props.confirmHideSuggested},this.categories={upcoming:[{group:"today",title:"Today",icon:"icon-star",iconClass:"today"},{group:"unscheduled",title:"Scheduling",icon:"icon-schedule",iconClass:"schedule"},{group:"thisWeekUpcoming",title:"This week",icon:"icon-up",iconClass:"this-week"},{group:"nextWeek",title:"Next week",icon:"icon-up",iconClass:"next-week"},{group:"furtherInFuture",title:"Future",icon:"icon-up",iconClass:"future"}],past:[{group:"yesterday",title:"Yesterday",icon:"icon-down1",iconClass:"past"},{group:"thisWeekBefore",title:"This week",icon:"icon-down1",iconClass:"past"},{group:"lastWeek",title:"Last week",icon:"icon-down1",iconClass:"past"},{group:"furtherInPast",title:"Past",icon:"icon-down1",iconClass:"past"}]}},render:function(){var TimelineList,TimelineListItem,TimelineTabs,div,h1,i,ref,ref1,span;return ref=React.DOM,h1=ref.h1,div=ref.div,span=ref.span,i=ref.i,ref1=React.DOM.Meeting,TimelineTabs=ref1.TimelineTabs,TimelineList=ref1.TimelineList,TimelineListItem=ref1.TimelineListItem,div({},TimelineTabs({tab:this.state.tab,switchTab:this.switchTab}),this.categories[this.state.tab].map(function(_this){return function(category,ci){return null!=_this.props.allMeetings&&_this.props.allMeetings[category.group].length?div({className:"timeline-list",key:ci},h1({className:"timeline-list-header"},span({className:"timeline-header-icon "+category.iconClass},i({className:"icon "+category.icon})),span({className:"meeting-category-title"},category.title)),_this.props.allMeetings[category.group].map(function(meetings,mi){return meetings.length?TimelineList({key:"".concat(ci,mi),meetings:meetings,ngCallbacks:_this.ngCallbacks,ng:_this.ng}):void 0
})):void 0}}(this)))}})}),ReactComponentFactory.createFactory("TimelineList","Meeting",{displayName:"TimelineList",propTypes:{meetings:React.PropTypes.array.isRequired},render:function(){var TimelineListItem,div,li,ref,ul;return ref=React.DOM,ul=ref.ul,li=ref.li,div=ref.div,TimelineListItem=React.DOM.Meeting.TimelineListItem,ul({className:"timeline-list-container"},parseInt(this.props.meetings[0].begin_epoch)?div({className:"timeline-list-date"},div({className:"day"},moment.unix(this.props.meetings[0].begin_epoch).format(this.props.ng.dateHelper.formatDayOfWeek)),div({className:"date"},moment.unix(this.props.meetings[0].begin_epoch).format(this.props.ng.dateHelper.isEpochThisYear(this.props.meetings[0].begin_epoch)?this.props.ng.dateHelper.formatDate:this.props.ng.dateHelper.formatDateYear))):div({className:"timeline-list-date"},"Time not decided"),this.props.meetings.map(function(_this){return function(meeting){return li({className:"timeline-list-item",key:meeting.id},TimelineListItem({meeting:meeting,ngCallbacks:_this.props.ngCallbacks,ng:_this.props.ng}))}}(this)))}}),ReactComponentFactory.createFactory("TimelineListItem","Meeting",{displayName:"TimelineListItem",propTypes:{meeting:React.PropTypes.object.isRequired},isRsvpRequired:function(meeting){var participant,userId;return userId=this.props.ng.sessionService.getUserId(),participant=this.props.ng.participantService.getParticipant(userId,meeting.participants),this.props.ng.participantService.isRsvpRequired(participant)},getRsvpPropertyName:function(meeting){return 0!==meeting.current_scheduling_id?"has_answered_current_scheduling":"rsvp_status"},getInitialState:function(){return{suggestMeeting:0,suggestionBtnWorking:null}},handleSuggestMeeting:function(e){return this.state.suggestMeeting===e.detail.meetingId?this.setState({suggestMeeting:0}):e.detail.meetingId===this.props.meeting.id?this.setState({suggestMeeting:e.detail.meetingId}):void 0},createSuggested:function(){return this.setState({suggestionBtnWorking:"create"}),this.props.ngCallbacks.createSuggested(this.props.meeting)},hideSuggested:function(){return this.setState({suggestionBtnWorking:"hide"}),this.props.ngCallbacks.confirmHideSuggested(this.props.meeting,null,function(_this){return function(){return _this.setState({suggestionBtnWorking:null})}}(this))},componentDidMount:function(){return window.addEventListener("suggestMeeting",this.handleSuggestMeeting)},componentWillUnmount:function(){return window.removeEventListener("suggestMeeting",this.handleSuggestMeeting)},render:function(){var ParticipantList,ParticipantSummary,button,div,h2,i,meeting,ref,ref1,span;return ref=React.DOM,h2=ref.h2,div=ref.div,span=ref.span,i=ref.i,button=ref.button,ref1=React.DOM.Participant,ParticipantList=ref1.ParticipantList,ParticipantSummary=ref1.ParticipantSummary,meeting=this.props.meeting,div({},div({className:"meeting-wrapper",onClick:function(_this){return function(){return _this.props.ngCallbacks.openOrSuggest(meeting)}}(this)},meeting.is_draft&&0!==meeting.matchmaking_accepted?div({className:"draft"},"Participants not invited"):void 0,meeting.is_suggested_meeting?div({className:"suggested"},"Suggestion from ",meeting.source_name):void 0,0===meeting.matchmaking_accepted?div({className:"matchmaking"},"Meeting request from ",meeting.matchmaking_requester_name):void 0,this.isRsvpRequired(meeting)?div({className:"invitation"},"Meeting invitation"):void 0,h2({className:"timeline-list-title"},meeting.title_value?meeting.title_value:"Untitled meeting"),div({className:"timeline-list-duration"},i({className:"icon icon-time"}),0===meeting.begin_epoch&&0===meeting.current_scheduling_id?span({},"Date is not set"):0===meeting.begin_epoch&&0!==meeting.current_scheduling_id?span({},"Scheduling"):0!==meeting.begin_epoch?span({},moment.unix(meeting.begin_epoch).format(this.props.ng.dateHelper.formatTime)," ‒ ",moment.unix(meeting.end_epoch).format(this.props.ng.dateHelper.formatTime)," – ",span({},this.props.ng.dateHelper.durationString(meeting.begin_epoch,meeting.end_epoch))):void 0),div({className:"timeline-list-location"},function(){var ref2;if(meeting.online_conferencing_option)switch(meeting.online_conferencing_option){case"hangout":return span({className:"online-location"},i({className:"icon icon-hangout"}),span({},"On Hangout"));case"skype":return span({className:"online-location"},i({className:"icon icon-skype"}),span({},"On Skype"),!meeting.location_value&&(null!=(ref2=meeting.online_conferencing_data)?ref2.skype_account:void 0)?span({},": ",meeting.online_conferencing_data.skype_account):void 0);case"lync":return span({className:"online-location"},i({className:"icon icon-lync"}),span({},"On Lync"));case"teleconf":return span({className:"online-location"},i({className:"icon icon-onlineconf"}),span({},"On the phone"));case"custom":return span({className:"online-location"},i({className:"icon icon-custom"}),span({},"Online"))}}(),meeting.location_value||!meeting.online_conferencing_option?span({className:"physical-location"},i({className:"icon icon-location"}),meeting.location_value?span({},meeting.location_value):span({},"Location is undecided")):void 0),meeting.participants.length<=this.props.ng.appConfig.meeting.participants.maxCountBeforeSummary?ParticipantList({participants:meeting.participants,rsvpPropertyName:this.getRsvpPropertyName(meeting),showRsvp:0===meeting.current_scheduling_id}):void 0,meeting.participants.length>this.props.ng.appConfig.meeting.participants.maxCountBeforeSummary?ParticipantSummary({participants:meeting.participants,rsvpPropertyName:this.getRsvpPropertyName(meeting),shortSummary:0!==meeting.current_scheduling_id,ng:this.props.ng}):void 0),this.state.suggestMeeting===meeting.id?div({className:"suggestion-actions"},button({disabled:this.state.suggestionBtnWorking,onClick:this.createSuggested},"Set up this meeting","create"===this.state.suggestionBtnWorking?span({className:"spinner"}):void 0),button({className:"secondary  "+("upcoming"===this.props.tab?"tab-selected":void 0),disabled:this.state.suggestionBtnWorking,onClick:this.hideSuggested},"Hide this event","hide"===this.state.suggestionBtnWorking?span({className:"spinner"}):void 0)):void 0)}}),ReactComponentFactory.createFactory("TimelineTabs","Meeting",{displayName:"TimelineTabs",switchTab:function(tab){return this.props.switchTab(tab)},render:function(){var button,div,ref;return ref=React.DOM,div=ref.div,button=ref.button,div({className:"timeline-tabs"},button({className:"timeline-tab "+("upcoming"===this.props.tab?"tab-selected":void 0),onClick:function(_this){return function(){return _this.switchTab("upcoming")}}(this)},"Upcoming"),button({className:"timeline-tab "+("past"===this.props.tab?"tab-selected":void 0),onClick:function(_this){return function(){return _this.switchTab("past")}}(this)},"Past"))}});var notificationComponents;notificationComponents=angular.module("notificationComponents",["react","dateHelper"]),notificationComponents.factory("NotificationList",function(dateHelper){return React.createClass({displayName:"NotificationList",propTypes:{notifications:React.PropTypes.array.isRequired,open:React.PropTypes.func.isRequired},render:function(){var NotificationListItem,Timestamp,div,ref,ref1;return ref=React.DOM,div=ref.div,Timestamp=ref.Timestamp,NotificationListItem=React.DOM.Notifications.NotificationListItem,div({},null!=(ref1=this.props.notifications)?ref1.map(function(_this){return function(notification){var className,meetingTitle,notificationListItem,ref2;return meetingTitle=(null!=(ref2=notification.data.meeting)?ref2.title_value:void 0)||"Untitled meeting",className="notification",notification.is_read||(className+=" notification-new"),notificationListItem=NotificationListItem({notification:notification,meetingTitle:meetingTitle}),div({className:className,onClick:function(){return _this.props.open(notification)}},notificationListItem,Timestamp({dateHelper:dateHelper,createdAt:notification.created_epoch}))}}(this)):void 0)}})}),ReactComponentFactory.createFactory("NotificationListItem","Notifications",{displayName:"NotificationListItem",propTypes:{notification:React.PropTypes.object.isRequired,meetingTitle:React.PropTypes.string.isRequired},render:function(){var div,i,ref,span,strong;return ref=React.DOM,div=ref.div,span=ref.span,i=ref.i,strong=ref.strong,div({},i({className:"icon "+("icon-"+this.props.notification.data.icon+" ")+("icon-color-"+this.props.notification.data.icon_color)}),span({className:"notification-text",dangerouslySetInnerHTML:{__html:this.props.notification.data.template}}))}}),ReactComponentFactory.createFactory("ParticipantList","Participant",{displayName:"ParticipantList",propTypes:{participants:React.PropTypes.array.isRequired,rsvpPropertyName:React.PropTypes.string.isRequired,showRsvp:React.PropTypes.bool.isRequired},render:function(){var Avatar,li,ref,ul;return ref=React.DOM,ul=ref.ul,li=ref.li,Avatar=ref.Avatar,ul({className:"participant-list-container"},this.props.participants.map(function(_this){return function(participant){return li({className:"participant-list-item",key:participant.user_id},Avatar({className:"participant-list-item-avatar",user:participant,rsvpPropertyName:_this.props.rsvpPropertyName,showRsvp:_this.props.showRsvp||!0}))}}(this)))}}),ReactComponentFactory.createFactory("ParticipantSummary","Participant",{displayName:"ParticipantSummary",propTypes:{participants:React.PropTypes.array.isRequired,shortSummary:React.PropTypes.bool.isRequired,rsvpPropertyName:React.PropTypes.string.isRequired},render:function(){var attending,declined,div,pending,ref,span;return ref=React.DOM,div=ref.div,span=ref.span,attending=this.props.ng.participantService.getAttendingCount(this.props.participants,this.props.rsvpPropertyName),pending=this.props.ng.participantService.getPendingCount(this.props.participants,this.props.rsvpPropertyName),declined=this.props.ng.participantService.getDeclinedCount(this.props.participants,this.props.rsvpPropertyName),this.props.shortSummary?this.props.shortSummary?div({className:"participant-summary"},this.props.participants.length," participants"):void 0:div({className:"participant-summary"},span({className:"participant-summary-yes"},span({className:"rsvp-bullet rsvp-yes"}),attending," attending, "),span({className:"participant-summary-maybe"},span({className:"rsvp-bullet rsvp-maybe"}),pending," unknown, "),span({className:"participant-summary-no"},span({className:"rsvp-bullet rsvp-no"}),declined," declined"))}});